(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"1jcm":function(e,t,i){"use strict";i.d(t,"a",function(){return x}),i.d(t,"b",function(){return k});var a=i("GU7r"),s=i("fXoL"),n=i("FKr1"),o=i("8LU1"),r=i("3Pt+"),l=i("R1ws"),c=i("u47x");const d=["thumbContainer"],h=["toggleBar"],g=["input"],u=function(){return{enterDuration:150}},m=["*"],b=new s.s("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let p=0;const f={provide:r.q,useExisting:Object(s.X)(()=>x),multi:!0};class v{constructor(e,t){this.source=e,this.checked=t}}class y{constructor(e){this._elementRef=e}}const S=Object(n.C)(Object(n.x)(Object(n.y)(Object(n.z)(y)),"accent"));let x=(()=>{class e extends S{constructor(e,t,i,a,n,o){super(e),this._focusMonitor=t,this._changeDetectorRef=i,this.defaults=n,this._animationMode=o,this._onChange=e=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++p,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new s.o,this.toggleChange=new s.o,this.tabIndex=parseInt(a)||0}get required(){return this._required}set required(e){this._required=Object(o.c)(e)}get checked(){return this._checked}set checked(e){this._checked=Object(o.c)(e),this._changeDetectorRef.markForCheck()}get inputId(){return(this.id||this._uniqueId)+"-input"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{"keyboard"===e||"program"===e?this._inputElement.nativeElement.focus():e||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(e){e.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(e){e.stopPropagation()}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}focus(e,t){t?this._focusMonitor.focusVia(this._inputElement,t,e):this._inputElement.nativeElement.focus(e)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new v(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(s.l),s.Rb(c.h),s.Rb(s.h),s.cc("tabindex"),s.Rb(b),s.Rb(l.a,8))},e.\u0275cmp=s.Lb({type:e,selectors:[["mat-slide-toggle"]],viewQuery:function(e,t){if(1&e&&(s.Uc(d,1),s.Uc(h,1),s.Uc(g,1)),2&e){let e;s.Cc(e=s.gc())&&(t._thumbEl=e.first),s.Cc(e=s.gc())&&(t._thumbBarEl=e.first),s.Cc(e=s.gc())&&(t._inputElement=e.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(e,t){2&e&&(s.ac("id",t.id),s.Gb("tabindex",t.disabled?null:-1)("aria-label",null)("aria-labelledby",null),s.Jb("mat-checked",t.checked)("mat-disabled",t.disabled)("mat-slide-toggle-label-before","before"==t.labelPosition)("_mat-animation-noopable","NoopAnimations"===t._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[s.Eb([f]),s.Cb],ngContentSelectors:m,decls:16,vars:18,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(e,t){if(1&e&&(s.pc(),s.Xb(0,"label",0,1),s.Xb(2,"div",2,3),s.Xb(4,"input",4,5),s.fc("change",function(e){return t._onChangeEvent(e)})("click",function(e){return t._onInputClick(e)}),s.Wb(),s.Xb(6,"div",6,7),s.Sb(8,"div",8),s.Xb(9,"div",9),s.Sb(10,"div",10),s.Wb(),s.Wb(),s.Wb(),s.Xb(11,"span",11,12),s.fc("cdkObserveContent",function(){return t._onLabelTextChange()}),s.Xb(13,"span",13),s.Pc(14,"\xa0"),s.Wb(),s.oc(15),s.Wb(),s.Wb()),2&e){const e=s.Dc(1),i=s.Dc(12);s.Gb("for",t.inputId),s.Fb(2),s.Jb("mat-slide-toggle-bar-no-side-margin",!i.textContent||!i.textContent.trim()),s.Fb(2),s.qc("id",t.inputId)("required",t.required)("tabIndex",t.tabIndex)("checked",t.checked)("disabled",t.disabled),s.Gb("name",t.name)("aria-checked",t.checked.toString())("aria-label",t.ariaLabel)("aria-labelledby",t.ariaLabelledby),s.Fb(5),s.qc("matRippleTrigger",e)("matRippleDisabled",t.disableRipple||t.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",s.tc(17,u))}},directives:[n.s,a.a],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),e})(),C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({}),e})(),k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({imports:[[C,n.t,n.j,a.c],C,n.j]}),e})()},c03H:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var a=i("hM+/"),s=i("A9VE"),n=function(e){Object(a.a)(e,"InterfaceColorSet")&&(e.setFor("stroke",Object(s.b)("#000000")),e.setFor("fill",Object(s.b)("#2b2b2b")),e.setFor("primaryButton",Object(s.b)("#6794dc").lighten(-.2)),e.setFor("primaryButtonHover",Object(s.b)("#6771dc").lighten(-.2)),e.setFor("primaryButtonDown",Object(s.b)("#68dc75").lighten(-.2)),e.setFor("primaryButtonActive",Object(s.b)("#68dc75").lighten(-.2)),e.setFor("primaryButtonText",Object(s.b)("#FFFFFF")),e.setFor("primaryButtonStroke",Object(s.b)("#6794dc")),e.setFor("secondaryButton",Object(s.b)("#3b3b3b")),e.setFor("secondaryButtonHover",Object(s.b)("#3b3b3b").lighten(.1)),e.setFor("secondaryButtonDown",Object(s.b)("#3b3b3b").lighten(.15)),e.setFor("secondaryButtonActive",Object(s.b)("#3b3b3b").lighten(.15)),e.setFor("secondaryButtonText",Object(s.b)("#bbbbbb")),e.setFor("secondaryButtonStroke",Object(s.b)("#3b3b3b").lighten(-.2)),e.setFor("grid",Object(s.b)("#bbbbbb")),e.setFor("background",Object(s.b)("#000000")),e.setFor("alternativeBackground",Object(s.b)("#ffffff")),e.setFor("text",Object(s.b)("#ffffff")),e.setFor("alternativeText",Object(s.b)("#000000")),e.setFor("disabledBackground",Object(s.b)("#bbbbbb"))),Object(a.a)(e,"Scrollbar")&&(e.background.fillOpacity=.4,e.thumb.background.fillOpacity=.5)}},xOm6:function(e,t,i){"use strict";i.r(t),i.d(t,"StudentDetailModule",function(){return K});var a=i("ofXK"),s=i("tyNb"),n=i("mrSG"),o=i("LRne"),r=i("cp0P"),l=i("AytR"),c=i("fXoL"),d=i("v0EB"),h=i("iiAa");let g=(()=>{class e{constructor(e,t){this.as=e,this.utility=t,this.sessionData={overAllSessionMins:[],overAllSessionSeconds:[],userSessionMins:[],userSessionSeconds:[],mergedDataSecWise:[],mergedDataMinWise:[]},this.gap=0}getCompiledData(e,t,i){i&&(this.gap=(new Date(i.video_start).getTime()-new Date(t[0].createdAt).getTime())/1e3),e=e.map((e,t)=>(e.segment=t+1,e)),this.sessionData.overAllSessionSeconds=this.findClosestDate(t[0].createdAt,t[t.length-1].createdAt,e),this.sessionData.overAllSessionMins=this.secToMin_overAll(e),this.sessionData.userSessionSeconds=t,this.sessionData.userSessionMins=this.secToMin_user(t),this.sessionData.mergedDataSecWise=this.sessionData.overAllSessionSeconds.map((e,t)=>Object.assign({},e,this.sessionData.userSessionSeconds[t])).filter(e=>{if(e.createdAt)return e}),this.sessionData.mergedDataMinWise=this.equaliseMin_Sec_length(this.sessionData.userSessionMins,this.sessionData.overAllSessionMins);const{mergedDataSecWise:a,mergedDataMinWise:s}=this.sessionData;return{mergedDataSecWise:a,mergedDataMinWise:s}}secToMin_overAll(e){const t=[];let i=0,a=0,s=0;const n=e.length,o=this.diff_minutes(new Date(e[0].timestamp),new Date(e[e.length-1].timestamp)).minutes,r=this.diff_minutes(new Date(e[0].timestamp),new Date(e[e.length-1].timestamp)).seconds,l=Math.round(n/((60*o+r)/60));return e.map((e,n)=>{a+=e.average_engagement,s+=e.average_mood,n%l==0&&(t.push({segment:i++,average_engagement:Math.round(a/l),average_mood:Math.round(s/l),category:this.utility.setCategory(Math.round(a/l)),moodCategory:this.utility.setCategory(Math.round(s/l))}),a=0,s=0)}),t}secToMin_user(e){const t=[];let i=0,a=0,s=0;const n=e.length,o=this.diff_minutes(new Date(e[0].createdAt),new Date(e[e.length-1].createdAt)).minutes,r=this.diff_minutes(new Date(e[0].createdAt),new Date(e[e.length-1].createdAt)).seconds,l=Math.round(n/((60*o+r)/60));return e=e.map((e,n)=>{a+=e.engagement,s+=e.mood,n%l==0&&(t.push({segment:i++,engagement:Math.round(a/l),mood:Math.round(s/l),category:this.utility.setCategory(Math.round(a/l)),moodCategory:this.utility.setCategory(Math.round(s/l))}),a=0,s=0)}),t}diff_minutes(e,t){let i=(t.getTime()-e.getTime())/1e3,a=(t.getTime()-e.getTime())/1e3;return i/=60,a%=60,{minutes:Math.abs(Math.floor(i)),seconds:Math.round(a)}}findClosestDate(e,t,i){if(i){let a=1;i.map(i=>{i.diffFromStart=Math.abs((new Date(i.timestamp).getTime()-new Date(e).getTime())/1e3),i.diffFromEnd=Math.abs((new Date(i.timestamp).getTime()-new Date(t).getTime())/1e3)});const s=i.reduce((e,t)=>e.diffFromStart<t.diffFromStart?e:t),n=i.reduce((e,t)=>e.diffFromEnd<t.diffFromEnd?e:t);return i.filter((e,t)=>{if(e.timestamp>=s.timestamp&&e.timestamp<=n.timestamp)return e.overallsegment=a++,e})}}equaliseMin_Sec_length(e,t){const i=t.filter(({segment:t})=>!e.some(({segment:e})=>e===t));return(t=t.filter(e=>!i.includes(e))).map((e,t)=>Object.assign({},e,this.sessionData.userSessionMins[t]))}}return e.\u0275fac=function(t){return new(t||e)(c.bc(d.a),c.bc(h.a))},e.\u0275prov=c.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var u=i("cclQ"),m=i("kYN2"),b=i("tk/3"),p=i("0Lug"),f=i("XiUz"),v=i("znSr"),y=i("1jcm"),S=i("xJfa"),x=i("WlQZ"),C=i("c03H"),k=i("LUsR");let _=(()=>{class e{constructor(e,t,i,a,s,n,o){this.as=e,this.bhvSub=t,this.as$=i,this.zone=a,this.router=s,this.route=n,this.utility=o,this.seekVideoFrom=new c.o,this.chartLoadCheck=!1,this.metric=0,this.segmentArray=[],this.yAxisLabels=[{value:0,text:"Camera Off"},{value:40,text:"Low"},{value:80,text:"Medium"},{value:100,text:"High"}],this.series=[{name:"Engagement",color:"#ff8b51"},{name:"Mood",color:"#1393ff"}]}createChart(){const e=this;this.segmentArray="Seconds"===this.secMin?this.createSegment(Math.floor(this.utility.getSegmentData(this.allSeriesData.mergedDataSecWise).duration/4)):this.createMinutesQuadrants(),u.k(x.a),u.k(C.a),this.config.chart=u.e(this.stdId,S.i),this.config.chart.data="Seconds"===this.secMin?this.allSeriesData.mergedDataSecWise:this.allSeriesData.mergedDataMinWise;const t=this.config.chart.xAxes.push(new S.a);t.dataFields.category="segment",t.renderer.grid.template.disabled=!0,t.cursorTooltipEnabled=!1;const i=this.config.chart.yAxes.push(new S.h);i.renderer.labels.template.disabled=!0,i.cursorTooltipEnabled=!1,i.renderer.line.strokeOpacity=0,i.min=0,i.max=110,i.renderer.grid.template.disabled=!0;const a=this.config.chart.yAxes.push(new S.a);function s(e){const i=t.axisRanges.create();i.category=e,i.grid.strokeOpacity=.5,i.label.text="",i.tick.disabled=!0,i.tick.strokeOpacity=.5}function n(e,i,a){const s=t.axisRanges.create();s.category=e,s.endCategory=i,s.label.text=a,s.label.location=.5,s.label.horizontalCenter="middle",s.label.fontWeight="bold",s.label.inside=!0,s.label.valign="top",s.label.events.on("hit",()=>{t.zoomToIndexes(s.category,s.endCategory)})}function o(e,t){const a=i.axisRanges.create();a.value=e,a.label.text=t}a.dataFields.category="category",a.cursorTooltipEnabled=!1,a.renderer.labels.template.disabled=!0,a.renderer.grid.template.disabled=!0,[{name:"engagement",value:0},{name:"mood",value:1},{name:"average_engagement",value:0},{name:"average_mood",value:1}].forEach(e=>{const t=this.config.chart.series.push(new S.e);0===e.value&&"engagement"===e.name?(t.tooltipText='Engagement : {engagement.formatNumber(".##")}',t.segments.template.fill=u.d("#1393ff"),t.stroke=u.d("#1393ff"),t.fill=u.d("#1393ff")):0===e.value&&"average_engagement"===e.name?(t.tooltipText='Overall Engagement : {average_engagement.formatNumber(".##")}',t.segments.template.fill=u.d("#ff8b51"),t.stroke=u.d("#ff8b51"),t.fill=u.d("#ff8b51")):1===e.value&&"mood"===e.name?(t.tooltipText='Mood : {mood.formatNumber(".##")}',t.segments.template.fill=u.d("#1393ff"),t.stroke=u.d("#1393ff"),t.fill=u.d("#1393ff")):1===e.value&&"average_mood"===e.name&&(t.tooltipText='Overall Mood : {average_mood.formatNumber(".##")}',t.segments.template.fill=u.d("#ff8b51"),t.stroke=u.d("#ff8b51"),t.fill=u.d("#ff8b51")),t.fillOpacity=1;const i=new u.c;i.opacities=[.7,0],i.offsets=[0,1],i.gradient.rotation=90,t.segments.template.fillModifier=i;const{dataFields:a,tooltip:s}=t;a.valueY=e.name,t.hidden=e.value!==this.metric,a.categoryX="segment",t.strokeWidth=2,t.minBulletDistance=15,s.background.cornerRadius=20,s.background.strokeOpacity=0,s.pointerOrientation="vertical",s.label.minWidth=20,s.label.minHeight=20,s.label.textAlign="middle",s.label.textValign="middle";const n=t.bullets.push(new S.b);n.circle.strokeWidth=2,n.circle.radius=4,n.circle.fill=u.d("#fff"),n.states.create("hover").properties.scale=1.3,this.config.chart.cursor=new S.j});for(let l=0;l<4;l++)n(this.segmentArray[l].start,this.segmentArray[l].end,this.segmentArray[l].label),s(this.segmentArray[l].start),o(this.yAxisLabels[l].value,this.yAxisLabels[l].text);function r(t){const i=t.target,a=i.getPositionLabel(i.start),s=i.getPositionLabel(i.end);e.debounce&&clearInterval(e.debounce),e.debounce=setTimeout(()=>{e.seekVideoFrom.emit({Start:a,End:s})},100)}this.config.chart.cursor.lineX.stroke=u.d("red"),this.config.chart.cursor.lineX.strokeWidth=2,this.config.chart.cursor.lineX.strokeOpacity=.5,t.events.on("startchanged",r),t.events.on("endchanged",r)}ngOnInit(){this.route.queryParams.subscribe(e=>{this.params=e}),this.bhvSub.engOrMood$.subscribe(e=>{if("number"==typeof e&&this.config.chart){this.metric=e;const t=this.config.chart.series.getIndex(0),i=this.config.chart.series.getIndex(1),a=this.config.chart.series.getIndex(2),s=this.config.chart.series.getIndex(3);this.config.chart.series.values.map((e,n)=>{0===this.metric?(t.show(),i.hide(),a.show(),s.hide()):(t.hide(),i.show(),a.hide(),s.show())})}})}ngAfterViewInit(){this.config.chart?(this.config.chart.dispose(),setTimeout(()=>{this.createChart()},1e3)):this.createChart()}ngOnChanges(e){if((null==e?void 0:e.secMin)&&this.chartLoadCheck)if("Minutes"===e.secMin.currentValue){let e=0;this.config.chart.data=this.allSeriesData.mergedDataMinWise,this.segmentArray=this.createMinutesQuadrants();for(let t=0;t<7;t++)t%2==0?(this.config.chart.xAxes.values[0].axisRanges.values[t].properties.category=this.segmentArray[e].start,this.config.chart.xAxes.values[0].axisRanges.values[t].properties.endCategory=this.segmentArray[e].end,this.config.chart.xAxes.values[0].axisRanges.values[t].label.text=this.segmentArray[e].label,e++):this.config.chart.xAxes.values[0].axisRanges.values[t].properties.category=this.segmentArray[e].start;this.config.chart.validateData()}else if("Seconds"===e.secMin.currentValue){let e=0;this.config.chart.data=this.allSeriesData.mergedDataSecWise,this.segmentArray=this.createSegment(Math.floor(this.utility.getSegmentData(this.allSeriesData.mergedDataSecWise).duration/4));for(let t=0;t<7;t++)t%2==0?(this.config.chart.xAxes.values[0].axisRanges.values[t].properties.category=this.segmentArray[e].start,this.config.chart.xAxes.values[0].axisRanges.values[t].properties.endCategory=this.segmentArray[e].end,this.config.chart.xAxes.values[0].axisRanges.values[t].label.text=this.segmentArray[e].label,e++):this.config.chart.xAxes.values[0].axisRanges.values[t].properties.category=this.segmentArray[e].start;this.config.chart.validateData()}(null==e?void 0:e.allSeriesData)&&(this.chartLoadCheck=!0,this.config.chart?(this.config.chart.dispose(),setTimeout(()=>{this.createChart()},1e3)):this.createChart())}createMinutesQuadrants(){const e=Math.floor(this.allSeriesData.mergedDataMinWise.length/4);let t=0===this.allSeriesData.mergedDataMinWise[0].segment?0:this.allSeriesData.mergedDataMinWise[0].segment,i=t+e;const a=[];for(let s=0;s<4;s++)a.push({start:""+t,end:""+(i>this.allSeriesData.mergedDataMinWise.length-1?this.allSeriesData.mergedDataMinWise.length-1:i),label:this.utility.convertDate(e*s,4*e)+" - "+this.utility.convertDate(e*(s+1),4*e)}),t+=e,i+=e;return a}createSegment(e){let t=1,i=t+Math.floor(this.allSeriesData.mergedDataSecWise.length/4);const a=[];for(let s=0;s<4;s++)a.push({start:""+t,end:i>=this.allSeriesData.mergedDataSecWise.length-1?this.allSeriesData.mergedDataSecWise.length-1:i,label:this.utility.convertDate(e*s,4*e)+" - "+this.utility.convertDate(e*(s+1),4*e)}),t+=Math.floor(this.allSeriesData.mergedDataSecWise.length/4),i+=Math.floor(this.allSeriesData.mergedDataSecWise.length/4);return a}ngOnDestroy(){this.chartLoadCheck=!1;try{this.zone.runOutsideAngular(()=>{this.chart&&(this.config.chart.dispose(),delete this.config.chart)})}catch(e){console.log(e)}}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(d.a),c.Rb(k.a),c.Rb(d.a),c.Rb(c.B),c.Rb(s.b),c.Rb(s.a),c.Rb(h.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["app-line-chart"]],inputs:{stdId:"stdId",config:"config",detectChartDataChange:"detectChartDataChange",secMin:"secMin",allSeriesData:"allSeriesData"},outputs:{seekVideoFrom:"seekVideoFrom"},features:[c.Db],decls:1,vars:1,consts:[["fxFill","",3,"id"]],template:function(e,t){1&e&&c.Sb(0,"div",0),2&e&&c.qc("id",t.stdId)},directives:[f.h],styles:[""]}),e})();var D=i("NFeN"),M=i("Xa2L");const w=["video"],O=["videoScreenAudiio"],F=["screen"];function A(e,t){if(1&e&&(c.Vb(0),c.Xb(1,"video",14,15),c.Sb(3,"source",16),c.Wb(),c.Ub()),2&e){const e=c.jc(2);c.Fb(3),c.qc("src","https://"+e.dataRaw.screen_path.link,c.Hc)}}function T(e,t){if(1&e&&(c.Xb(0,"span",17),c.Pc(1),c.Wb()),2&e){const e=c.jc(2);c.Fb(1),c.Rc("Screen Share ",null==e.dataRaw?null:e.dataRaw.screen_path.status,"")}}const R=function(e){return[e]};function I(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",23),c.Xb(1,"mat-icon",24),c.fc("click",function(){c.Fc(e),c.jc();const t=c.Dc(3),i=c.jc(2);return i.detectChartDataChange=!1,t.paused?t.play():t.pause(),t.paused?i.toggleScreenShare():i.noop}),c.Pc(2),c.Wb(),c.Wb()}if(2&e){c.jc();const e=c.Dc(3);c.qc("ngClass",c.uc(2,R,e.paused?"display":"child")),c.Fb(2),c.Rc(" ",e.paused?"play_circle_outline":"pause_circle_outline"," ")}}function j(e,t){if(1&e&&c.Sb(0,"source",25),2&e){const e=c.jc(3);c.qc("src","https://"+(null==e.dataRaw.video_path?null:e.dataRaw.video_path.link),c.Hc)}}function P(e,t){if(1&e&&c.Sb(0,"source",26),2&e){const e=c.jc(3);c.qc("src","https://"+(null==e.dataRaw.audio_path?null:e.dataRaw.audio_path.link),c.Hc)}}function L(e,t){if(1&e){const e=c.Yb();c.Vb(0),c.Nc(1,I,3,4,"div",18),c.Xb(2,"video",19,20),c.fc("timeupdate",function(t){c.Fc(e);const i=c.Dc(3);return c.jc(2).videoTimeUpdate(t,i.paused)}),c.Nc(4,j,1,1,"source",21),c.Nc(5,P,1,1,"source",22),c.Wb(),c.Ub()}if(2&e){const e=c.jc(2);c.Fb(1),c.qc("ngIf",e.dispChartType&&"-"!==e.dataRaw.video_path.link),c.Fb(3),c.qc("ngIf",e.dispChartType&&"-"!==e.dataRaw.video_path.link),c.Fb(1),c.qc("ngIf",!e.dispChartType)}}function W(e,t){if(1&e&&(c.Xb(0,"span",17),c.Pc(1),c.Wb()),2&e){const e=c.jc(2);c.Fb(1),c.Rc("Video ",e.dataRaw.video_path.status,"")}}const V=function(){return{height:"60%"}},E=function(){return{height:"90%"}};function q(e,t){if(1&e){const e=c.Yb();c.Xb(0,"div",2),c.Xb(1,"div",3),c.Xb(2,"div",4),c.Nc(3,A,4,1,"ng-container",5),c.Nc(4,T,2,1,"span",6),c.Wb(),c.Xb(5,"div",7),c.Nc(6,L,6,3,"ng-container",5),c.Nc(7,W,2,1,"span",6),c.Wb(),c.Wb(),c.Xb(8,"div",8),c.Xb(9,"span",9),c.Pc(10,"Time Elapsed"),c.Wb(),c.Xb(11,"div",10),c.Xb(12,"span",11),c.Pc(13,"Seconds"),c.Wb(),c.Xb(14,"mat-slide-toggle",12),c.fc("change",function(t){c.Fc(e);const i=c.jc();return i.config.minuteToggle=i.detectChartDataChange=t.checked}),c.Wb(),c.Xb(15,"span",11),c.Pc(16,"Minutes"),c.Wb(),c.Wb(),c.Wb(),c.Xb(17,"app-line-chart",13),c.fc("seekVideoFrom",function(t){return c.Fc(e),c.jc().seekVideoFrom(t)}),c.Wb(),c.Wb()}if(2&e){const e=c.jc();c.Fb(2),c.qc("ngStyle.lt-xl",c.tc(18,V))("ngStyle",c.tc(19,E))("hidden",e.dataRaw.screen_path),c.Fb(1),c.qc("ngIf","-"!==e.dataRaw.screen_path.link||e.liveStreamVideo),c.Fb(1),c.qc("ngIf","-"===(null==e.dataRaw?null:e.dataRaw.screen_path.link)&&!e.liveStreamVideo),c.Fb(1),c.qc("ngStyle.lt-xl",c.tc(20,V))("ngStyle",c.tc(21,E))("hidden","-"===e.dataRaw.video_path.link||!e.liveStreamVideo),c.Fb(1),c.qc("ngIf","-"!==e.dataRaw.video_path.link||e.liveStreamVideo),c.Fb(1),c.qc("ngIf","-"===e.dataRaw.video_path.link&&!e.liveStreamVideo),c.Fb(7),c.qc("checked",e.config.minuteToggle)("disabled",e.disableToggle),c.Fb(3),c.qc("stdId","lineChart")("detectChartDataChange",e.detectChartDataChange)("secMin",e.config.minuteToggle?"Minutes":"Seconds")("config",e.config)("allSeriesData",e.allSeriesData)("hidden",!e.dispChartType)}}const X=function(){return["customLoader"]};function B(e,t){1&e&&c.Sb(0,"mat-spinner",27),2&e&&c.qc("ngClass",c.tc(2,X))("diameter",50)}let N=(()=>{class e{constructor(e,t,i,a,s,n,o){this.route=e,this.ss=t,this.http=i,this.as$=a,this.sl=s,this.sds=n,this.utility=o,this.screenShareSeek={start:u.g,end:u.g},this.base=l.a.base,this.videoTimeCounter=0,this.pauseVideoAt=0,this.time="00:00:00",this.liveStreamVideo=!1,this.dispChartType=!0,this.disableToggle=!1,this.eng=[],this.value=[],this.config={chart:void 0,minuteToggle:!1,video:void 0,dataRaw:void 0}}ngOnInit(){this.route.queryParams.subscribe(e=>{var t;if(e&&e.student_id)if(this.params=e,this.roomId=e.roomid,this.nitin(e.roomid),"manager"!==(null===(t=this.params)||void 0===t?void 0:t.module));else{this.dispChartType=!1;let e={};this.sl.load("janus").then(t=>{this.sl.load("user").then(i=>{t[0].loaded&&i[0].loaded&&(e=MediaStreams.filter(e=>{if(e.id===this.params.student_id&&"video"===e.type)return this.liveStreamVideo=!0,e}),setTimeout(()=>{const t=document.getElementById("video");t&&(t.srcObject=e[0].stream,t.play())},3e3))})})}setTimeout(()=>{this.detectChartDataChange=!1},2e3)}),this.userDetails=JSON.parse(localStorage.getItem("userDetails")),this.email=this.userDetails.email,this.as$.getApiStatic("userplanDetails?email="+this.email).subscribe(e=>{this.scoresTimeGap=e.data[0].realTimeScores})}nitin(e){this.as$.getApiStatic("getReportData?roomid="+e).subscribe(e=>{this.eng=e.report.overallEngagement,this.getData(this.params)})}getData(e){const t=Object(o.a)(this.eng),i=this.as$.getApiStatic("report?id="+e.student_id),a=this.as$.getApiStatic("getScreenShareDetails?uuid="+e.student_id);Object(r.a)([t,i,a]).subscribe(e=>{var t,i,a,s;(null===(t=e[1].response)||void 0===t?void 0:t.session_data)&&(e[1].response.session_data=e[1].response.session_data.sort((e,t)=>e.segment-t.segment),this.dataRaw=e[1].response,this.disableToggle=this.utility.calculateDuration([e[1].response]).duration<60,null===(a=null===(i=e[1].response)||void 0===i?void 0:i.session_data)||void 0===a||a.map(e=>(e.engagement=null===e.engagement?0:e.engagement,e.mood=null===e.mood?0:e.mood,e.category=this.utility.setCategory(e.engagement),e.moodCategory=this.utility.setCategory(e.mood),e))),this.allSeriesData=this.sds.getCompiledData(e[0],e[1].response.session_data,null===(s=e[2].data)||void 0===s?void 0:s.janus),console.log("All Series Data :",this.allSeriesData),setTimeout(()=>{void 0!==this.screen&&this.configureScreenShare(this.screen.nativeElement)},1e3)},e=>{console.error(e)})}videoTimeUpdate(e,t,i=!1){var a,s,n,o,r;void 0===this.screen||t||(console.log("Inside IF"),this.seekScreenShareVideoFrom(Math.floor(e.target.currentTime)));const l=document.getElementById("video");if((null===(s=null===(a=this.config)||void 0===a?void 0:a.chart)||void 0===s?void 0:s.data[(null===(r=null===(o=null===(n=this.config)||void 0===n?void 0:n.chart)||void 0===o?void 0:o.data)||void 0===r?void 0:r.length)-1].segment)>=Math.floor(e.target.currentTime)){0!==this.pauseVideoAt&&this.videoTimeCounter+Math.floor(e.target.currentTime/this.scoresTimeGap)>=this.pauseVideoAt&&l.pause();const t=this.config.chart.xAxes.values[0].categoryToPoint(this.videoTimeCounter+Math.floor(e.target.currentTime/this.scoresTimeGap));this.config.chart.cursor.triggerMove(t,"sticky")}else{0!==this.pauseVideoAt&&Math.floor(e.target.currentTime/this.scoresTimeGap)>=this.pauseVideoAt&&l.pause();const t=this.config.chart.xAxes.values[0].categoryToPoint(Math.floor(e.target.currentTime/this.scoresTimeGap));this.config.chart.cursor.triggerMove(t,"sticky")}}seekVideoFrom(e){return Object(n.b)(this,void 0,void 0,function*(){console.log("ScreenShare Seek : ",e);const t=yield document.getElementById("video"),i=yield document.getElementById("screenShare");this.videoTimeCounter=0,this.pauseVideoAt=e.End,t.currentTime=e.Start*this.scoresTimeGap,this.videoTimeCounter=e.Start,void 0!==this.screen&&(console.log("IF"),this.screenShareSeek.start=this.sds.gap+e.Start,this.screenShareSeek.end=this.sds.gap+e.Start+ +JSON.stringify(null==i?void 0:i.duration).split(".")[0],e.Start<this.sds.gap||e.Start>this.sds.gap+ +JSON.stringify(null==i?void 0:i.duration).split(".")[0]?(console.log("IF inside IF"),i.currentTime=this.sds.gap):(console.log("ELSE inside IF"),i.currentTime=e.Start))})}seekScreenShareVideoFrom(e){console.log("seekScreenShareVideoFrom : ",e);const t=document.getElementById("screenShare");e>=+this.screenShareSeek.start&&e<+this.screenShareSeek.end?(console.log("ScreenShare Sec : "+e+" , this.screenShareSeek.start : ",this.screenShareSeek.start),t.play()):t.pause()}configureScreenShare(e){this.screenShareSeek.start=this.sds.gap,this.screenShareSeek.end=this.sds.gap+ +JSON.stringify(null==e?void 0:e.duration).split(".")[0],console.log("Start :",this.screenShareSeek.start),console.log("End :",this.screenShareSeek.end),console.log("Gap :",this.sds.gap)}toggleScreenShare(){setTimeout(()=>{void 0!==this.screen&&this.screen.nativeElement.pause()},500)}}return e.\u0275fac=function(t){return new(t||e)(c.Rb(s.a),c.Rb(m.a),c.Rb(b.b),c.Rb(d.a),c.Rb(p.a),c.Rb(g),c.Rb(h.a))},e.\u0275cmp=c.Lb({type:e,selectors:[["app-student-detail"]],viewQuery:function(e,t){if(1&e&&(c.Uc(w,1),c.Uc(O,1),c.Uc(F,1)),2&e){let e;c.Cc(e=c.gc())&&(t.video=e.first),c.Cc(e=c.gc())&&(t.videoScreenAudiio=e.first),c.Cc(e=c.gc())&&(t.screen=e.first)}},features:[c.Eb([g])],decls:2,vars:2,consts:[["fxLayout","column","fxFill","","fxLayoutGap","14px","padding","",4,"ngIf"],[3,"ngClass","diameter",4,"ngIf"],["fxLayout","column","fxFill","","fxLayoutGap","14px","padding",""],["fxLayout","row","fxFlex","","fxLayoutAlign","space-around center","m-t0","","m-b0",""],["fxLayout","column","fxLayoutAlign","center center",1,"parentScreen",3,"ngStyle.lt-xl","ngStyle","hidden"],[4,"ngIf"],["style","color: #fff;",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"parentVideo",3,"ngStyle.lt-xl","ngStyle","hidden"],["fxLayout","row","fxLayoutAlign","space-between"],["title-white14-400","","fxLayoutAlign","center center"],["fxLayout","row","fxLayoutAlign","end center","p-r24","","p-l24","","border",""],["title-white12-400",""],["m-r12","","m-l12","",3,"checked","disabled","change"],["fxFlex","",3,"stdId","detectChartDataChange","secMin","config","allSeriesData","hidden","seekVideoFrom"],["id","screenShare","muted","","border","",2,"height","auto","width","auto","max-height","100%","max-width","100%"],["screen",""],["type","video/webm",3,"src"],[2,"color","#fff"],["id","vidPlayPause","fxFill","","fxLayout","row","fxLayoutAlign","center center",3,"ngClass",4,"ngIf"],["id","video","muted","","border","",3,"timeupdate"],["video",""],["id","lineChartVideo","type","video/webm",3,"src",4,"ngIf"],["id","liveLineChartVideo","type","audio/opus",3,"src",4,"ngIf"],["id","vidPlayPause","fxFill","","fxLayout","row","fxLayoutAlign","center center",3,"ngClass"],[3,"click"],["id","lineChartVideo","type","video/webm",3,"src"],["id","liveLineChartVideo","type","audio/opus",3,"src"],[3,"ngClass","diameter"]],template:function(e,t){1&e&&(c.Nc(0,q,18,22,"div",0),c.Nc(1,B,1,3,"mat-spinner",1)),2&e&&(c.qc("ngIf",t.allSeriesData),c.Fb(1),c.qc("ngIf",!t.allSeriesData))},directives:[a.n,f.f,f.h,f.g,f.b,f.e,v.c,a.o,y.a,_,a.l,v.a,D.a,M.c],styles:[".parentVideo[_ngcontent-%COMP%]{position:relative;width:350px;background:hsla(0,0%,100%,.1)}.parentVideo[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{height:100%;width:100%;transform:rotateY(180deg);-webkit-transform:rotateY(180deg);-moz-transform:rotateY(180deg)}.parentVideo[_ngcontent-%COMP%]   .display[_ngcontent-%COMP%]{visibility:visible}.parentVideo[_ngcontent-%COMP%]   .child[_ngcontent-%COMP%], .parentVideo[_ngcontent-%COMP%]   .display[_ngcontent-%COMP%]{position:absolute;background-color:rgba(0,0,0,.5);height:100%;width:100%;z-index:2}.parentVideo[_ngcontent-%COMP%]   .child[_ngcontent-%COMP%]{visibility:hidden}.parentVideo[_ngcontent-%COMP%]:hover   .child[_ngcontent-%COMP%]{visibility:visible}.parentScreen[_ngcontent-%COMP%]{position:relative;width:500px;background:hsla(0,0%,100%,.1)}.parentScreen[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{height:100%;width:100%\n  }.parentScreen[_ngcontent-%COMP%]   .display[_ngcontent-%COMP%]{visibility:visible}.parentScreen[_ngcontent-%COMP%]   .child[_ngcontent-%COMP%], .parentScreen[_ngcontent-%COMP%]   .display[_ngcontent-%COMP%]{position:absolute;background-color:rgba(0,0,0,.5);height:100%;width:100%;z-index:2}.parentScreen[_ngcontent-%COMP%]   .child[_ngcontent-%COMP%]{visibility:hidden}.parentScreen[_ngcontent-%COMP%]:hover   .child[_ngcontent-%COMP%]{visibility:visible}.mat-icon[_ngcontent-%COMP%]{font-size:48px!important;color:#fff;cursor:pointer}.customLoader[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),e})();var U=i("Wp6s"),G=i("FKr1");i("nLfN");let z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({imports:[[G.j],G.j]}),e})();var H=i("bTqV"),J=i("YUcS"),Y=i("FpXt");let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({imports:[[Y.a]]}),e})();const $=[{path:"",component:N}];let K=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Pb({type:e}),e.\u0275inj=c.Ob({imports:[[a.c,Y.a,U.b,z,H.b,y.b,J.a,Q,M.b,s.d.forChild($)]]}),e})()}}]);