(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{k78V:function(e,t,o){"use strict";o.d(t,"a",function(){return k});var n=o("ofXK"),i=o("FpXt"),a=o("0IaG"),r=o("NFeN"),s=o("jaxi"),l=o("bTqV"),c=o("3Pt+"),u=o("qFsG"),d=o("f0Cb"),m=o("iadO"),p=o("n1FK"),h=o("kmnG"),b=o("Wp6s"),g=o("A5z7"),v=o("tk/3"),f=o("/1cH"),y=o("kRoH"),x=o("o9rZ"),w=o("L/mj"),I=o("Qu3c"),S=o("fXoL");let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.Pb({type:e}),e.\u0275inj=S.Ob({imports:[[n.c,i.a,a.e,r.b,s.c,l.b,a.e,c.x,u.c,d.b,m.h,p.c,p.e,p.d,h.e,b.b,g.e,v.c,f.b,y.b.forRoot({provide:x.a,useFactory:w.a}),I.b]]}),e})()},o9rZ:function(e,t,o){"use strict";o.d(t,"a",function(){return n});var n=function(){return function(){}}()},pdnW:function(e,t,o){"use strict";o.d(t,"a",function(){return A});var n=o("3Pt+"),i=o("0IaG"),a=o("FtGj"),r=o("v0EB"),s=o("fXoL"),l=o("XiUz"),c=o("kmnG"),u=o("qFsG"),d=o("ofXK"),m=o("NFeN"),p=o("n1FK"),h=o("iadO"),b=o("A5z7"),g=o("bTqV"),v=o("Qu3c"),f=o("/1cH"),y=o("FKr1"),x=o("znSr");function w(e,t){1&e&&(s.Xb(0,"mat-error",37),s.Pc(1," Meeting name should be of minimum "),s.Xb(2,"b"),s.Pc(3,"2"),s.Wb(),s.Pc(4," characters "),s.Wb())}function I(e,t){1&e&&(s.Xb(0,"mat-icon",40),s.Pc(1,"cancel"),s.Wb())}function S(e,t){if(1&e){const e=s.Yb();s.Xb(0,"mat-chip",38),s.fc("removed",function(){s.Fc(e);const o=t.$implicit;return s.jc().remove(o)}),s.Pc(1),s.Nc(2,I,2,0,"mat-icon",39),s.Wb()}if(2&e){const e=t.$implicit,o=s.jc();s.qc("selectable",o.selectable)("removable",o.removable),s.Fb(1),s.Rc(" ",e," "),s.Fb(1),s.qc("ngIf",o.removable)}}function k(e,t){if(1&e&&(s.Xb(0,"mat-error"),s.Pc(1),s.Wb()),2&e){const e=s.jc();s.Fb(1),s.Rc(" ",e.chipError," ")}}const F=function(e){return{cursor:e}};let A=(()=>{class e{constructor(e,t,o){var i,r,s;this.data=e,this.fb=t,this.dialogRef=o,this.observerAccess=!1,this.date=new Date,this.emailids=[],this.topicRegex=/^[a-zA-Z][A-Za-z0-9\xe0\xe1\xe2\xe4\xe3\xe5\u0105\u010d\u0107\u0119\xe8\xe9\xea\xeb\u0117\u012f\xec\xed\xee\xef\u0142\u0144\xf2\xf3\xf4\xf6\xf5\xf8\xf9\xfa\xfb\xfc\u0173\u016b\xff\xfd\u017c\u017a\xf1\xe7\u010d\u0161\u017e\xc0\xc1\xc2\xc4\xc3\xc5\u0104\u0106\u010c\u0116\u0118\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\u012e\u0141\u0143\xd2\xd3\xd4\xd6\xd5\xd8\xd9\xda\xdb\xdc\u0172\u016a\u0178\xdd\u017b\u0179\xd1\xdf\xc7\u0152\xc6\u010c\u0160\u017d\u2202\xf0 ,.'-]+$/u,this.emailRegExp=/^([a-z0-9_\.\-])+\@(([a-z0-9\-])+\.)+([a-z0-9]{2,4})+$/,this.separatorKeysCodes=[a.g,a.c,a.o],this.addOnBlur=!0,this.selectable=!0,this.removable=!0,this.eventForm=this.fb.group({summary:["",[n.z.required,n.z.pattern(this.topicRegex)]],description:["",n.z.required],observerEmail:[{value:"",disabled:!JSON.parse(localStorage.getItem("userPlanDetails")||"{}").observerAccess},n.z.pattern(this.emailRegExp)],start:t.group({dateTime:[void 0!==(null==e?void 0:e.calDateSelect)?new Date(e.calDateSelect):this.date,n.z.required],timeZone:[Intl.DateTimeFormat().resolvedOptions().timeZone]}),recurrence:["RRULE:FREQ=DAILY;COUNT=2"],conferenceData:this.fb.group({entryPoints:this.fb.array([this.fb.group({entryPointType:["video"],uri:["https://dev.monetrewards.com/monetEdu/student/login?roomid=123"],label:["monet education"]})]),conferenceSolution:this.fb.group({name:["Monet Education Conference"],iconUri:["https://dev.monetrewards.com/logom.png"]}),notes:["There are some notes"]}),attendees:["",n.z.required],link:["Monet Education",n.z.required],reminders:t.group({useDefault:[!1],overrides:t.array([t.group({method:["email"],minutes:[1440]}),t.group({method:["popup"],minutes:10})])})}),this.endDate=new Date(new Date(null===(s=null===(r=null===(i=this.eventForm)||void 0===i?void 0:i.get("start"))||void 0===r?void 0:r.get("dateTime"))||void 0===s?void 0:s.value).getTime()+36e5)}ngOnInit(){this.observerAccess=!JSON.parse(localStorage.getItem("userPlanDetails")||"{}").observerAccess}add(e){(e.value||"").trim()&&(!1===this.emailRegExp.test(e.value)?this.chipError=e.value+" is not an email address":(this.chipError="",this.emailids.push(e.value.trim()),this.eventForm.controls.attendees.setValue(this.emailids))),e.input.value=""}remove(e){this.emailids.indexOf(e)>=0&&this.emailids.splice(this.emailids.indexOf(e),1)}onFileChanged(e){if(this.selectedFile=e.target.files[0],!this.selectedFile)return;const t=new FileReader;t.onload=e=>{const t=e.target.result.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);null==t||t.forEach(e=>{this.emailids.push(e)})},t.readAsText(this.selectedFile)}valueChanged(e){var t,o,n;"startDate"===e&&(this.endDate=new Date(new Date(null===(n=null===(o=null===(t=this.eventForm)||void 0===t?void 0:t.get("start"))||void 0===o?void 0:o.get("dateTime"))||void 0===n?void 0:n.value).getTime()+36e5))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(i.a),s.Rb(n.g),s.Rb(i.f))},e.\u0275cmp=s.Lb({type:e,selectors:[["app-add-event"]],features:[s.Eb([r.a])],decls:67,vars:24,consts:[["fxLayout","column",3,"formGroup"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","20px",2,"margin-bottom","10px"],["fxFlex","24px"],["floatLabel","never","fxFlex","",1,"mat-headline"],["matInput","","formControlName","summary","placeholder","Monet discussion","value",""],["fxLayout","row","fxLayoutAlign","center start",2,"width","100%","color","#c8663c !important"],["style","margin-top: -10% !important;",4,"ngIf"],["fxLayout","row","fxLayoutGap","16px","fxLayoutAlign","start center"],["formGroupName","start","fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","20px",2,"width","100%"],["matInput","","placeholder","Choose a date","formControlName","dateTime",3,"ngxMatDatetimePicker","min","dateChange"],["matSuffix","",3,"for"],[3,"enableMeridian","showSpinners","showSeconds","stepHour","stepMinute","stepSecond","touchUi","startAt"],["picker1",""],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","20px",2,"width","102%"],["floatLabel","never","fxFlex","",2,"margin-right","0px"],["aria-label","Fruit selection"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["matInput","","type","text","placeholder","Type Email",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[4,"ngIf"],["mat-icon-button","","matTooltip","Upload Email Id's",3,"click"],["type","file","hidden","true","multiple","true","id","fileInput","name","files","accept",".csv,.xlsx,.xml",3,"change"],["fileInput",""],["fxLayoutAlign","start center","fxLayoutGap","20px"],["floatLabel","never","fxFlex",""],["matInput","","placeholder","Choose Conference","value","","formControlName","link",3,"matAutocomplete"],["auto","matAutocomplete"],["value","Monet Education"],["aria-hidden","","src","../../../../../../../assets/m-logo.svg",1,"conf-icon"],["small",""],["value","Google Meet"],["aria-hidden","","src","../../../../../../../assets/hangouts-meet.svg",1,"conf-icon"],["matInput","","formControlName","description","placeholder","Monet discussion","value",""],["matInput","","type","email","formControlName","observerEmail",3,"placeholder","ngStyle"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","",1,"custom-button",3,"disabled","click"],[2,"margin-top","-10% !important"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""]],template:function(e,t){if(1&e){const e=s.Yb();s.Xb(0,"form",0),s.Xb(1,"div",1),s.Sb(2,"div",2),s.Xb(3,"mat-form-field",3),s.Xb(4,"mat-label"),s.Pc(5,"Add topic"),s.Wb(),s.Sb(6,"input",4),s.Wb(),s.Wb(),s.Xb(7,"div",5),s.Nc(8,w,5,0,"mat-error",6),s.Wb(),s.Xb(9,"div",7),s.Xb(10,"mat-icon"),s.Pc(11,"watch_later"),s.Wb(),s.Xb(12,"mat-form-field",8),s.Xb(13,"input",9),s.fc("dateChange",function(){return t.valueChanged("startDate")}),s.Wb(),s.Sb(14,"mat-datepicker-toggle",10),s.Sb(15,"ngx-mat-datetime-picker",11,12),s.Wb(),s.Wb(),s.Xb(17,"div",13),s.Xb(18,"mat-icon"),s.Pc(19,"group"),s.Wb(),s.Xb(20,"mat-form-field",14),s.Xb(21,"mat-chip-list",15,16),s.Nc(23,S,3,4,"mat-chip",17),s.Xb(24,"input",18),s.fc("matChipInputTokenEnd",function(e){return t.add(e)}),s.Wb(),s.Wb(),s.Nc(25,k,2,1,"mat-error",19),s.Wb(),s.Xb(26,"button",20),s.fc("click",function(){return s.Fc(e),s.Dc(28).click()}),s.Xb(27,"input",21,22),s.fc("change",function(e){return t.onFileChanged(e)}),s.Wb(),s.Xb(29,"mat-icon"),s.Pc(30,"attach_file"),s.Wb(),s.Wb(),s.Wb(),s.Xb(31,"div",23),s.Xb(32,"mat-icon"),s.Pc(33,"videocam"),s.Wb(),s.Xb(34,"mat-form-field",24),s.Xb(35,"mat-label"),s.Pc(36,"Link"),s.Wb(),s.Sb(37,"input",25),s.Xb(38,"mat-autocomplete",null,26),s.Xb(40,"mat-option",27),s.Xb(41,"div",7),s.Sb(42,"img",28),s.Xb(43,"span",29),s.Pc(44,"Monet Education (Recommended)"),s.Wb(),s.Wb(),s.Wb(),s.Xb(45,"mat-option",30),s.Xb(46,"div",7),s.Sb(47,"img",31),s.Xb(48,"span",29),s.Pc(49,"Google Meet"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(50,"div",23),s.Xb(51,"mat-icon"),s.Pc(52,"description"),s.Wb(),s.Xb(53,"mat-form-field",24),s.Xb(54,"mat-label"),s.Pc(55,"Description"),s.Wb(),s.Sb(56,"input",32),s.Wb(),s.Wb(),s.Xb(57,"div",23),s.Xb(58,"mat-icon"),s.Pc(59,"person"),s.Wb(),s.Xb(60,"mat-form-field",24),s.Sb(61,"input",33),s.Wb(),s.Wb(),s.Xb(62,"mat-dialog-actions",34),s.Xb(63,"button",35),s.fc("click",function(){return t.dialogRef.close()}),s.Pc(64,"No Thanks"),s.Wb(),s.Xb(65,"button",36),s.fc("click",function(){return t.dialogRef.close({form:t.eventForm.value,emails:t.emailids,url:t.videoUri,end:{dateTime:t.endDate,timeZone:"Asia/Calcutta"}})}),s.Pc(66,"Create"),s.Wb(),s.Wb(),s.Wb()}if(2&e){const e=s.Dc(16),o=s.Dc(22),n=s.Dc(39);s.qc("formGroup",t.eventForm),s.Fb(8),s.qc("ngIf",null==t.eventForm.get("summary").errors?null:t.eventForm.get("summary").errors.pattern),s.Fb(5),s.qc("ngxMatDatetimePicker",e)("min",t.date),s.Fb(1),s.qc("for",e),s.Fb(1),s.qc("enableMeridian",!0)("showSpinners",!0)("showSeconds",!1)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("startAt",t.date),s.Fb(8),s.qc("ngForOf",t.emailids),s.Fb(1),s.qc("matChipInputFor",o)("matChipInputSeparatorKeyCodes",t.separatorKeysCodes)("matChipInputAddOnBlur",t.addOnBlur),s.Fb(1),s.qc("ngIf",t.chipError),s.Fb(12),s.qc("matAutocomplete",n),s.Fb(24),s.qc("placeholder",t.observerAccess?"Upgrade your plan to avail this feature":"Type Observer Email here (Optional)")("ngStyle",s.uc(22,F,t.observerAccess?"not-allowed":"auto")),s.Fb(4),s.qc("disabled","INVALID"===t.eventForm.status)}},directives:[n.A,n.t,l.f,n.k,l.e,l.g,l.b,c.c,c.g,u.b,n.d,n.s,n.i,d.n,m.a,n.l,p.a,h.i,c.h,p.b,b.c,d.m,b.b,g.a,v.a,f.c,f.a,y.n,d.o,x.c,i.c,c.b,b.a,b.d],styles:[".conf-icon[_ngcontent-%COMP%]{height:16px;width:16px}.mat-headline[_ngcontent-%COMP%]{font-size:24px;line-height:32px;font-weight:300}  .mat-form-field-wrapper{width:100%!important}"]}),e})()},"yB+K":function(e,t,o){"use strict";o.d(t,"a",function(){return g});var n=o("mrSG"),i=o("tk/3"),a=o("2Vo4"),r=o("fXoL"),s=o("tyNb"),l=o("0Lug"),c=o("v0EB"),u=o("E8bv"),d=o("iiAa");const m="591973291813-2l1evk1ru95g6372u0r98i3oqmnrlng5.apps.googleusercontent.com",p="AIzaSyCWg8dY5ZZMaDZ4LDiDNQooF4Nc3CEqPuA",h=["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],b="https://www.googleapis.com/auth/calendar";let g=(()=>{class e{constructor(e,t,o,n,i,r,s){this.router=e,this.sl=t,this.http=o,this.as=n,this.msalService=i,this.zone=r,this.utility=s,this.init=!1,this.loaderStat=new a.a(!1),this.rolePopup=new a.a(!1),gapi.load("client:auth2",this.googleInitClient())}isLoggedIn(){let e={status:!1,service:""};return e="true"===localStorage.getItem("GoogleLoginState")?{status:!0,service:"google"}:null!==this.msalService.instance.getActiveAccount()?{status:!0,service:"outlook"}:{status:!1,service:"monet"},e}tokenVerify(e){var t,o,n;this.utility.notify(e.message,"success"),e&&(null===(t=null==e?void 0:e.user)||void 0===t?void 0:t.plan)&&this.as.getApi("getPlan?planId="+(null===(o=e.user)||void 0===o?void 0:o.plan.id)).subscribe(e=>{localStorage.setItem("userPlanDetails",JSON.stringify(null==e?void 0:e.plan))}),this.sl.load("janus").then(e=>this.sl.load("user").then(t=>e[0].loaded&&t[0].loaded)),(null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.token)&&this.as.storeLocalStorage("userDetails",e.user),this.roleCheck(e)}roleCheck(e){this.zone.run(()=>{var t;"NaN"!==e.user.userType?this.router.navigate(["moderator"===(null===(t=e.user)||void 0===t?void 0:t.userType)?"profile/dashboard/":"/manager"],{queryParams:{name:e.user.name,licenseToken:null},queryParamsHandling:"merge"}):this.rolePopup.next(!0)})}loginFunc(e,t){this.http.post("https://www.monetlive.com/many/api/"+t,e).subscribe(e=>{this.loaderStat.next(!1),e.error?this.utility.notify(e.message,"error"):this.tokenVerify(e)})}updateRole(e,t){this.as.putApi("updateRole",e).subscribe(e=>{e.error?this.utility.notify(e.message,"error"):this.tokenVerify(e)})}googleInitClient(){gapi.load("client:auth2",()=>{gapi.client.init({apiKey:p,clientId:m,discoveryDocs:h,scope:b})})}googleLogIn(e){gapi.load("client:auth2",()=>{gapi.client.init({apiKey:p,clientId:m,discoveryDocs:h,scope:b}).then(()=>{gapi.auth2.getAuthInstance().signIn().then(t=>{const o=JSON.parse(sessionStorage.getItem("licenseToken")||"{}").value;this.gData=t.Lu,o?this.http.post("https://www.monetlive.com/many/api/register-invited-user",{token:t.xc.id_token,licenseToken:o,context:"google"}).subscribe(e=>{e.error||this.zone.run(()=>{this.as.storeLocalStorage("userDetails",e.user),this.router.navigate(["profile/dashboard/"],{queryParams:{name:e.user.name},queryParamsHandling:"merge"})})}):this.loginFunc({token:t.Cc.id_token},"auth/google"),this.init=!0,localStorage.setItem("GoogleLoginState","true"),e(this.init)}).catch(e=>{})}).catch(e=>{window.location.replace(this.getAuthUri())})})}createGoogleCalenderEvent(e){return Object(n.b)(this,void 0,void 0,function*(){return yield gapi.client.calendar.events.insert({calendarId:"primary",sendNotifications:!0,sendUpdates:"all",conferenceDataVersion:1,resource:e}).then(e=>e.result.id,e=>{console.error(e)})})}getGoogleCalenderEvents(){var e,t,o;return Object(n.b)(this,void 0,void 0,function*(){const n=new Date;return yield null===(o=null===(t=null===(e=null===gapi||void 0===gapi?void 0:gapi.client)||void 0===e?void 0:e.calendar)||void 0===t?void 0:t.events)||void 0===o?void 0:o.list({calendarId:"primary",timeMin:new Date(n.getFullYear(),n.getMonth(),1).toISOString(),showDeleted:!1,singleEvents:!0,maxResults:1e3,orderBy:"startTime"}).then(e=>e.result.items,e=>{console.error(e)})})}deleteGoogleCalenderEvent(e,t){gapi.client.load("calendar","v3",()=>{gapi.client.calendar.events.delete({calendarId:"primary",eventId:e,sendNotifications:!0,sendUpdates:"all"}).execute(e=>{var o,n;e.error||!1===e?("deleted"===(null===(n=null===(o=null==e?void 0:e.error)||void 0===o?void 0:o.errors)||void 0===n?void 0:n.reason)&&console.warn("Event has already been deleted"),t(!1)):t(!0)})})}getAuthUri(){localStorage.setItem("GoogleLoginState","true");let e=window.location.href;const t=e.indexOf("authentication");return t>-1&&(e.substring(t),e=e.substring(0,t)),"https://accounts.google.com/o/oauth2/v2/auth?client_id="+encodeURIComponent(m)+"&redirect_uri="+encodeURIComponent(e)+"&response_type="+encodeURIComponent("token id_token")+"&scope="+encodeURIComponent("profile email openid https://www.googleapis.com/auth/calendar")+"&openid.realm&include_granted_scopes="+encodeURIComponent("true")+"&nonce="+this.utility.create_UUID()}getHeaders(){return this.headers=new i.d({Authorization:"Bearer "+localStorage.getItem("MSAL_TOKEN")}),this.headers}outlookLogin(){return this.msalService.loginPopup({scopes:["Calendars.Read Calendars.ReadWrite Directory.Read.All Directory.ReadWrite.All User.Read User.Read.All User.ReadWrite User.ReadWrite.All profile openid email"],prompt:"select_account"}).subscribe(e=>{console.log("Outlook Login Successful :",e);const t=JSON.parse(sessionStorage.getItem("licenseToken")||"{}").value;t?this.http.post("https://www.monetlive.com/many/api/register-invited-user",{token:e.wc.id_token,licenseToken:t,context:"microsoft"}).subscribe(e=>{e.error||this.zone.run(()=>{this.as.storeLocalStorage("userDetails",e.user),this.router.navigate(["profile/dashboard/"],{queryParams:{name:e.user.name},queryParamsHandling:"merge"})})}):this.loginFunc({token:e.accessToken},"auth/microsoft"),localStorage.setItem("MSAL_TOKEN",e.accessToken),this.msalService.instance.setActiveAccount(e.account)},e=>{console.error("Login Error :",e)}),!0}outlookGetEvents(){return this.http.get("https://graph.microsoft.com/v1.0/me/events?$select=subject,attendees,start,end",{headers:this.getHeaders()})}outlookCreateEvent(e,t,o,n,i,a){const r={subject:e,body:{contentType:"HTML",content:`<div fxLayout="row" fxLayoutAlign="start center">\n                    <div style="background: #d9f2db">\n                        <span style="font-weight: bold"><strong>You have been invited to the following event.</strong></span>\n                    </div>\n                    <h3>\n                        <span style="color: #222; font-weight: bold; font-size: 16px;">${e}</span>\n                    </h3>\n                    <div fxLayout="column" fxLayoutAlign="center start">\n                        <i style="font-style:normal; color: #888; margin-right: 30px;">When</i>\n                        <span style="font-size: 13px; color: #222">${o}</span>\n                    </div>\n                    <div fxLayout="column" fxLayoutAlign="center start">\n                        <i style="font-style:normal; color: #888; margin-right: 11px;">Calender</i>\n                        <span style="font-size: 13px; color: #222">${JSON.parse(localStorage.getItem("userDetails")||"").email}</span>\n                    </div>\n                    <div style="display: flex; flex-direction: row">\n                        <i style="font-style:normal; font-size: 13px; color: #888; padding-top: 13px;">Who</i>\n                        <div >\n                            <ul>\n                                ${i.map(e=>`<li>${Object.values(Object.values(e)[0])[0]} <span style="color: #888">${Object.values(Object.values(e)[0])[0]===JSON.parse(localStorage.getItem("userDetails")||"").email.toString()?" - Organizer":""}</span></li>`).join("")}\n                            </ul>\n                        </div>\n                    </div>\n                    <div fxLayout="row">\n                        ${a}\n                    </div>\n                  </div>`},start:{dateTime:o,timeZone:"Asia/Calcutta"},end:{dateTime:n,timeZone:"Asia/Calcutta"},attendees:i};return this.http.post("https://graph.microsoft.com/v1.0/me/calendar/events",r,{headers:this.getHeaders()})}outlookDeleteEvent(e){return this.http.delete("https://graph.microsoft.com/v1.0/me/calendar/events/"+e,{headers:this.getHeaders()})}}return e.\u0275fac=function(t){return new(t||e)(r.bc(s.b),r.bc(l.a),r.bc(i.b),r.bc(c.a),r.bc(u.c),r.bc(r.B),r.bc(d.a))},e.\u0275prov=r.Nb({token:e,factory:e.\u0275fac}),e})()}}]);