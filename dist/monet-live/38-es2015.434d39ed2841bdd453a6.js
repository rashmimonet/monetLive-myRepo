(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{ErGM:function(t,e,i){"use strict";i.r(e),i.d(e,"DashboardModule",function(){return mt});var a=i("v0EB"),n=i("FPA4"),o=i("kYN2"),s=i("fXoL"),r=i("tyNb"),c=i("ofXK"),l=i("0Lug"),g=i("LUsR"),d=i("iiAa"),h=i("rkV7"),u=i("tk/3"),p=i("XiUz"),m=i("znSr"),f=i("1jcm"),b=i("Vs90"),y=i("cclQ"),D=i("xJfa"),v=i("c03H"),S=i("WlQZ"),x=i("mrSG"),C=i("v8aL"),L=i("8sDm"),O=i("hM+/"),M=i("Lzas"),_=i("oN2F"),F=i("kWzP"),P=i("UpBs"),A=function(t){function e(){var e=t.call(this)||this;return e.smallSlices=new L.a,e.bigSlices=new L.a,e.groupName="Other",e.groupProperties={},e.syncLegend=!1,e._threshold=5,e._clickDisposers=[],e._clickBehavior="none",e._ignoreDataUpdate=!1,e._closed=!0,e}return Object(x.c)(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.processSeries()},e.prototype.processSeries=function(){var t=this,e=this.target,i=e.chart,a=e.data&&e.data.length?e:i;this._dataProvider=a,this._disposers.push(a.events.on(!P.a.queue&&!P.a.onlyShowOnViewport||i.inited?"datavalidated":"inited",function(i){if(t._ignoreDataUpdate)t._ignoreDataUpdate=!1;else{t.groupSlice=void 0,t.smallSlices.clear(),t.bigSlices.clear();var n,o=0;if(e.dataItems.each(function(e,i){e.dataContext.sliceGrouperOther?n=e.dataContext:t.limit&&i>=t.limit||!t.limit&&e.values.value.percent<=t.threshold?(o+=e.value,e.hiddenInLegend=!0,e.hide(),e.hidden=!0,e.label.events.on("transitionended",function(i){t._closed&&e.hide()}),t.smallSlices.push(e.slice)):t.bigSlices.push(e.slice)}),o>0)if(n)n[e.dataFields.value]=o,t._ignoreDataUpdate=!0,a.validateRawData();else{var s={sliceGrouperOther:!0};s[e.dataFields.category]=t.groupName,s[e.dataFields.value]=o,t._ignoreDataUpdate=!0,a.addData(s)}}})),this._disposers.push(e.events.on("validated",function(i){e.slices.each(function(e){e.dataItem.dataContext.sliceGrouperOther&&(t.groupSlice||(t.groupSlice=e,t.initSlices()))})}))},e.prototype.initSlices=function(){var t=this;this.groupSlice&&(_.d(this.groupProperties,function(e,i){t.groupSlice[e]=i}),"none"!=this.clickBehavior&&(this.groupSlice.events.has("hit",this.toggleGroupOn,this)||this._clickDisposers.push(this.groupSlice.events.on("hit",this.toggleGroupOn,this))))},e.prototype.toggleGroupOn=function(){var t=this;"none"!=this.clickBehavior&&(this._closed=!1,this.groupSlice.dataItem.hide(),this.syncLegend&&(this.groupSlice.dataItem.hiddenInLegend=!0),this._clickDisposers.push(this.groupSlice.events.once("shown",function(e){t.toggleGroupOff()})),this.smallSlices.each(function(e){e.dataItem.hidden=!1,e.dataItem.show(),t.syncLegend&&(e.dataItem.hiddenInLegend=!1)}),"zoom"==this.clickBehavior&&this.bigSlices.each(function(e){e.dataItem.hide(),t.syncLegend&&(e.dataItem.hiddenInLegend=!0)}),this.syncLegend&&this.target.baseSprite.feedLegend(),this.zoomOutButton.show())},e.prototype.toggleGroupOff=function(){var t=this;"none"!=this.clickBehavior&&(this._closed=!0,this.groupSlice.events.disableType("shown"),this.groupSlice.dataItem.show(),this.groupSlice.events.enableType("shown"),this.syncLegend&&(this.groupSlice.dataItem.hiddenInLegend=!1),"zoom"==this.clickBehavior&&this.bigSlices.each(function(e){e.dataItem.hidden=!1,e.dataItem.show(),t.syncLegend&&(e.dataItem.hiddenInLegend=!1)}),this.smallSlices.each(function(e){e.dataItem.hide(),t.syncLegend&&(e.dataItem.hiddenInLegend=!0)}),this.syncLegend&&this.target.baseSprite.feedLegend(),this.zoomOutButton.hide())},Object.defineProperty(e.prototype,"threshold",{get:function(){return this._threshold},set:function(t){this._threshold!=t&&(this._threshold=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"limit",{get:function(){return this._limit},set:function(t){this._limit!=t&&(this._limit=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomOutButton",{get:function(){var t=this;if(!this._zoomOutButton){var e=this.target.baseSprite.tooltipContainer.createChild(M.a);e.shouldClone=!1,e.align="right",e.valign="top",e.zIndex=Number.MAX_SAFE_INTEGER,e.marginTop=5,e.marginRight=5,e.hide(0),this.zoomOutButton=e,this._disposers.push(this._zoomOutButton),e.events.on("hit",function(){t.toggleGroupOff()},this)}return this._zoomOutButton},set:function(t){this._zoomOutButton=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clickBehavior",{get:function(){return this._clickBehavior},set:function(t){this._clickBehavior!=t&&(this._clickBehavior=t,this.initSlices())},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){if(this.disposeClickEvents(),this.groupSlice=void 0,this.smallSlices.clear(),this.bigSlices.clear(),this._dataProvider&&F.e(this._dataProvider.data))for(var e=0;e<this._dataProvider.data.length;e++)if(this._dataProvider.data[e].sliceGrouperOther){this._dataProvider.data.splice(e,1),this._dataProvider.invalidateData();break}t.prototype.dispose.call(this)},e.prototype.disposeClickEvents=function(){var t=this._clickDisposers;for(this._clickDisposers=null;0!==t.length;)t.shift().dispose()},e}(C.a);O.b.registeredClasses.SliceGrouper=A;var w=i("Dhln");const k=function(){return["chart"]};let I=(()=>{class t{constructor(t,e,i,a,n){this.categoryPipe=t,this.as=e,this.zone=i,this.bhvSub=a,this.utility=n,this.chartReg={},this.categoryCount={High:0,Medium:0,Low:0,CamOff:0},this.subscription=this.bhvSub.engOrMood$.subscribe(t=>{this.engOrMood=t})}createChart(){y.k(v.a),y.k(S.a),y.h.commercialLicense=!0,this.chart=y.e(this.inpIn,D.f),this.chart.radius=y.i(40),this.chart.data=[{category:"HIGH",categoryValue:`${this.engOrMood?this.pieChartData.hi_percentage[2].uuid.length:this.pieChartData.hi_percentage[1].uuid.length} ${this.engOrMood?1===this.pieChartData.hi_percentage[2].uuid.length?"Student":"Students":1===this.pieChartData.hi_percentage[1].uuid.length?"Student":"Students"}`,value:this.engOrMood?this.pieChartData.hi_percentage[3]:this.pieChartData.hi_percentage[0],color:y.d("#1FA000")},{category:"MID",categoryValue:`${this.engOrMood?this.pieChartData.med_percentage[2].uuid.length:this.pieChartData.med_percentage[1].uuid.length} ${this.engOrMood?1===this.pieChartData.med_percentage[2].uuid.length?"Student":"Students":1===this.pieChartData.med_percentage[1].uuid.length?"Student":"Students"}`,value:this.engOrMood?this.pieChartData.med_percentage[3]:this.pieChartData.med_percentage[0],color:y.d("#D5AD2A")},{category:"LOW",categoryValue:`${this.engOrMood?this.pieChartData.low_percentage[2].uuid.length:this.pieChartData.low_percentage[1].uuid.length} ${this.engOrMood?1===this.pieChartData.low_percentage[2].uuid.length?"Student":"Students":1===this.pieChartData.low_percentage[1].uuid.length?"Student":"Students"}`,value:this.engOrMood?this.pieChartData.low_percentage[3]:this.pieChartData.low_percentage[0],color:y.d("#BA0E15")}];const t=this.chart.series.push(new D.g);t.dataFields.value="value",t.dataFields.category="category",t.slices.template.propertyFields.fill="color",t.slices.template.strokeOpacity=1,t.hiddenState.properties.opacity=1,t.hiddenState.properties.endAngle=-90,t.hiddenState.properties.startAngle=-90,t.labels.template.maxWidth=130,t.labels.template.wrap=!0,t.slices.template.tooltipText='{category} : {value.formatNumber(".##")}%',t.labels.template.adapter.add("text",(t,e,i)=>{e.html=e.dataItem&&"CAM OFF"===e.dataItem.category?'<div style="text-align: center;"><span style="color: #888787">{category}</span><br>{value.formatNumber(".##")}%<br>{categoryValue}</div>':'<div style="text-align: center;"><span style="color: {color}">{category}</span><br>{value.formatNumber(".##")}%<br>{categoryValue}</div>'}),t.alignLabels=!0,t.labels.template.radius=y.i(10),t.ticks.template.disabled=!1,t.ticks.template.stroke=y.d("white"),t.ticks.template.strokeWidth=1,t.ticks.template.strokeOpacity=1,t.ticks.template.length=2;const e=t.plugins.push(new A);e.threshold=0,e.groupName="Other",e.clickBehavior="none",this.chart.hiddenState.properties.radius=y.i(0)}ngOnInit(){this.pieChartData.UAE=this.pieChartData.UAE.map(t=>(t.category=this.utility.setCategory(t.average),t.moodCategory=this.utility.setCategory(t.average_mood),t));const t=[];this.pieChartData.UAE.map(e=>{t.push(e.category)});const e=t.reduce((t,e)=>(e in t?t[e]++:t[e]=1,t),{});this.categoryCount.High=e.High,this.categoryCount.Medium=e.Medium,this.categoryCount.Low=e.Low,this.bhvSub.engOrMood$.subscribe(t=>{this.engOrMood=t,this.chart?(this.chart.dispose(),setTimeout(()=>{this.createChart()},1e3)):this.createChart()})}ngAfterViewInit(){setTimeout(()=>{this.chart?(this.chart.dispose(),setTimeout(()=>{this.createChart()},1e3)):this.createChart()},100)}ngOnDestroy(){this.subscription.unsubscribe();try{this.zone.runOutsideAngular(()=>{this.chart&&(this.chart.dispose(),delete this.chart)})}catch(t){console.log(t)}}}return t.\u0275fac=function(e){return new(e||t)(s.Rb(w.a),s.Rb(a.a),s.Rb(s.B),s.Rb(g.a),s.Rb(d.a))},t.\u0275cmp=s.Lb({type:t,selectors:[["app-pie-chart"]],inputs:{inpIn:"inpIn",pieChartData:"pieChartData"},decls:1,vars:3,consts:[[3,"id","ngClass"]],template:function(t,e){1&t&&s.Sb(0,"div",0),2&t&&s.qc("id",e.inpIn)("ngClass",s.tc(2,k))},directives:[c.l,m.a],styles:[".chart[_ngcontent-%COMP%]{height:100%;width:100%}.AxisLabelCircular[_ngcontent-%COMP%]{background:red!important}"]}),t})();var W=i("NFeN"),N=i("Wp6s"),E=i("bTqV"),X=i("kmnG"),q=i("Xa2L");function G(t,e){if(1&t&&(s.Xb(0,"div",15),s.Pc(1),s.Wb()),2&t){const t=s.jc(2);s.Fb(1),s.Sc(" ",0===t.engOrMood?"Engagement":"Mood"," Percentage per ",t.headingDuration," minutes ")}}function R(t,e){1&t&&s.Sb(0,"span",17)}const z=function(t){return{visibility:t}},T=function(){return["upIcon"]};function j(t,e){if(1&t&&(s.Xb(0,"mat-icon",22),s.Pc(1,"arrow_drop_up"),s.Wb()),2&t){const t=s.jc().index,e=s.jc(2);s.qc("ngStyle",s.uc(2,z,e.selection===t?"visible":"hidden"))("ngClass",s.tc(4,T))}}function U(t,e){if(1&t){const t=s.Yb();s.Xb(0,"div",16),s.Xb(1,"span",17),s.Pc(2),s.Wb(),s.Xb(3,"app-pie-chart",18),s.fc("click",function(){s.Fc(t);const i=e.index,a=s.jc(2);return a.selection=i,a.cdRef.detectChanges(),a.studentListPanel(!0),a.segmentWiseScore(a.selection)}),s.Wb(),s.Nc(4,R,1,0,"span",19),s.Xb(5,"div",20),s.Nc(6,j,2,5,"mat-icon",21),s.Wb(),s.Wb()}if(2&t){const t=e.$implicit,i=e.index,a=s.jc(2);s.Fb(2),s.Qc(t.duration),s.Fb(1),s.qc("inpIn","container"+i)("pieChartData",a.pieChartData[i]),s.Fb(1),s.qc("ngIf",!a.dispStdList&&!a.dispCatSpecificData),s.Fb(2),s.qc("ngIf",a.dispStdList)}}const B=function(){return[]},H=function(t){return[t]},$=function(t){return{student_id:t}},V=function(){return{}};function K(t,e){if(1&t){const t=s.Yb();s.Xb(0,"div",33),s.fc("click",function(){return s.Fc(t),s.jc(5).cdRef.detectChanges()}),s.Xb(1,"mat-icon"),s.Pc(2,"account_circle"),s.Wb(),s.Xb(3,"div",34),s.Xb(4,"span",35),s.Pc(5),s.kc(6,"titlecase"),s.Wb(),s.Wb(),s.Xb(7,"span",36),s.Xb(8,"mat-icon",37),s.Pc(9,"fiber_manual_record"),s.Wb(),s.Wb(),s.Xb(10,"span",38),s.Pc(11),s.Wb(),s.Wb()}if(2&t){const t=s.jc().$implicit,e=s.jc().$implicit,i=s.jc(3);s.qc("ngClass",i.linkEnabled?"isLink":"")("routerLink",s.uc(10,H,i.linkEnabled?"../student-detail":s.tc(9,B)))("queryParams",i.linkEnabled?s.uc(12,$,t.uuid):s.tc(14,V))("queryParamsHandling","merge"),s.Fb(5),s.Qc(s.lc(6,7,t.name)),s.Fb(3),s.qc("ngClass",e.className),s.Fb(3),s.Qc(i.engOrMood?t.average_mood:t.average)}}function Y(t,e){if(1&t&&(s.Vb(0),s.Nc(1,K,12,15,"div",32),s.Ub()),2&t){const t=e.$implicit,i=s.jc().index,a=s.jc(3);s.Fb(1),s.qc("ngIf",(a.engOrMood?"High"===t.moodCategory:"High"===t.category)&&0===i||(a.engOrMood?"Medium"===t.moodCategory:"Medium"===t.category)&&1===i||(a.engOrMood?"Low"===t.moodCategory:"Low"===t.category)&&2===i)}}const J=function(t){return{color:t}},Q=function(){return["student-card"]};function Z(t,e){if(1&t){const t=s.Yb();s.Xb(0,"div",27),s.Xb(1,"h3",28),s.fc("click",function(){s.Fc(t);const i=e.$implicit;return s.jc(3).individualSegmentScores(i)}),s.Pc(2),s.Wb(),s.Xb(3,"p",29),s.Pc(4),s.Wb(),s.Xb(5,"div",30),s.Nc(6,Y,2,1,"ng-container",31),s.Wb(),s.Wb()}if(2&t){const t=e.$implicit,i=e.index,a=s.jc(3);s.Fb(1),s.qc("ngStyle",s.uc(8,J,t.color)),s.Fb(1),s.Sc("",t.name," ",0===a.engOrMood?t.eng:t.mood,""),s.Fb(2),s.Tc("",a.engOrMood?a.moodsegUsersArr[i]:a.segUsersArr[i]," ",1===a.segUsersArr[i]?"Participant":"Participants"," (",a.engOrMood?a.moodpercentArr[i]:a.percentArr[i],"%)"),s.Fb(1),s.qc("ngClass",s.tc(10,Q)),s.Fb(1),s.qc("ngForOf",a.pieChartData[a.selection].UAE)}}function tt(t,e){if(1&t){const t=s.Yb();s.Xb(0,"mat-card",23),s.Xb(1,"div",24),s.Xb(2,"button",25),s.fc("click",function(){return s.Fc(t),s.jc(2).dispStdList=!1}),s.Xb(3,"mat-icon"),s.Pc(4,"close"),s.Wb(),s.Wb(),s.Wb(),s.Nc(5,Z,7,11,"div",26),s.Wb()}if(2&t){const t=s.jc(2);s.Fb(5),s.qc("ngForOf",t.segments)}}function et(t,e){if(1&t){const t=s.Yb();s.Xb(0,"div",33),s.fc("click",function(){return s.Fc(t),s.jc(4).cdRef.detectChanges()}),s.Xb(1,"mat-icon"),s.Pc(2,"account_circle"),s.Wb(),s.Xb(3,"div",48),s.Xb(4,"span",49),s.Pc(5),s.kc(6,"titlecase"),s.Wb(),s.Wb(),s.Xb(7,"span",50),s.Xb(8,"mat-icon",37),s.Pc(9," fiber_manual_record"),s.Wb(),s.Wb(),s.Xb(10,"span",51),s.Pc(11),s.Wb(),s.Wb()}if(2&t){const t=e.$implicit,i=s.jc(4);s.qc("ngClass",i.linkEnabled?"isLink":"")("routerLink",s.uc(10,H,i.linkEnabled?"../student-detail":s.tc(9,B)))("queryParams",i.linkEnabled?s.uc(12,$,t.uuid):s.tc(14,V))("queryParamsHandling","merge"),s.Fb(5),s.Qc(s.lc(6,7,t.name)),s.Fb(3),s.qc("ngClass",i.segSpecificData.iconClassName),s.Fb(3),s.Rc("",i.engOrMood?t.average_mood:t.average," ")}}function it(t,e){if(1&t&&(s.Xb(0,"div",43),s.Xb(1,"mat-icon",44),s.Pc(2,"arrow_drop_up"),s.Wb(),s.Xb(3,"mat-card",45),s.Xb(4,"h3",46),s.Pc(5),s.Wb(),s.Xb(6,"p",29),s.Pc(7),s.Wb(),s.Xb(8,"div",5),s.Nc(9,et,12,15,"div",47),s.Wb(),s.Wb(),s.Wb()),2&t){const t=e.index,i=s.jc(3);s.Fb(1),s.qc("ngClass",s.tc(7,T)),s.Fb(3),s.qc("ngStyle",s.uc(8,J,i.segSpecificData.color)),s.Fb(1),s.Rc("",i.engOrMood?i.segSpecificData.name[1].name:i.segSpecificData.name[0].name," "),s.Fb(2),s.Tc("",i.engOrMood?null==i.segSpecificData?null:i.segSpecificData.moodParticipantsCount[t]:null==i.segSpecificData?null:i.segSpecificData.participantsCount[t]," ",i.engOrMood?1===(null==i.segSpecificData?null:i.segSpecificData.moodParticipantsCount[t])?"Participant":"Participants":1===(null==i.segSpecificData?null:i.segSpecificData.participantsCount[t])?"Participant":"Participants"," (",i.engOrMood?null==i.segSpecificData?null:i.segSpecificData.moodPercent[t]:null==i.segSpecificData?null:i.segSpecificData.percent[t],"%)"),s.Fb(2),s.qc("ngForOf",i.engOrMood?null==i.segSpecificData?null:i.segSpecificData.moodUsers[t]:null==i.segSpecificData?null:i.segSpecificData.users[t])}}function at(t,e){if(1&t){const t=s.Yb();s.Xb(0,"div",39),s.Xb(1,"div",40),s.Xb(2,"button",41),s.fc("click",function(){s.Fc(t);const e=s.jc(2);return e.dispCatSpecificData=!e.dispCatSpecificData,e.dispStdList=!e.dispStdList}),s.Xb(3,"mat-icon"),s.Pc(4,"close"),s.Wb(),s.Wb(),s.Wb(),s.Nc(5,it,10,10,"div",42),s.Wb()}if(2&t){const t=s.jc(2);s.Fb(5),s.qc("ngForOf",t.pieChartData)}}const nt=function(t){return{display:t}};function ot(t,e){if(1&t){const t=s.Yb();s.Xb(0,"div",3),s.Xb(1,"div",4),s.Xb(2,"div",5),s.Xb(3,"div",6),s.Xb(4,"span",7),s.Pc(5,"Seconds"),s.Wb(),s.Xb(6,"mat-slide-toggle",8),s.fc("change",function(){return s.Fc(t),s.jc().changeStatus()}),s.Wb(),s.Xb(7,"span",7),s.Pc(8,"Minutes"),s.Wb(),s.Wb(),s.Sb(9,"app-overall-line-chart",9),s.Wb(),s.Wb(),s.Nc(10,G,2,2,"div",10),s.Xb(11,"div",11),s.Nc(12,U,7,5,"div",12),s.Wb(),s.Nc(13,tt,6,1,"mat-card",13),s.Nc(14,at,6,1,"div",14),s.Wb()}if(2&t){const t=s.jc();s.Fb(1),s.qc("ngStyle",s.uc(7,nt,t.dispStdList||t.dispCatSpecificData?"none":"")),s.Fb(5),s.qc("checked",t.minuteToggle),s.Fb(3),s.qc("overallData",t.minuteToggle?t.sessionDataMinutes:t.sessionDataSeconds),s.Fb(1),s.qc("ngIf",0!==(null==t.segmentData?null:t.segmentData.length)),s.Fb(2),s.qc("ngForOf",t.segmentData),s.Fb(1),s.qc("ngIf",t.pieChartData&&t.pieChartData.length>0&&t.selection>=0&&t.dispStdList),s.Fb(1),s.qc("ngIf",t.dispCatSpecificData)}}function st(t,e){1&t&&(s.Vb(0),s.Xb(1,"div",52),s.Xb(2,"span",53),s.Pc(3,"No Data Available"),s.Wb(),s.Wb(),s.Ub())}const rt=function(){return["customLoader"]};function ct(t,e){1&t&&s.Sb(0,"mat-spinner",54),2&t&&s.qc("ngClass",s.tc(2,rt))("diameter",50)}let lt=(()=>{class t{constructor(t,e,i,a,n,o,s,r,c,l,g,d,h){this.router=t,this.date=e,this.api=i,this.ss=a,this.route=n,this.sl=o,this.cdRef=s,this.bhvSub=r,this.dashService=c,this.zone=l,this.utility=g,this.repo=d,this.http=h,this.minuteToggle=!0,this.sessionDataMinutes=[],this.sessionDataSeconds=[],this.percentArr=[],this.segUsersArr=[],this.moodpercentArr=[],this.moodsegUsersArr=[],this.duration=0,this.segmentData=[],this.students=[],this.dispStdList=!1,this.dispCatSpecificData=!1,this.studentData=[],this.dynamicLink="",this.lis=[],this.paymentError=!1,this.segments=[{name:"HIGH ",eng:"ENGAGEMENT",mood:"MOOD",indivSegKeyMap:"hi_percentage",category:"High",valMin:80,valMax:100,className:"title-success16-400",color:"#1FA000"},{name:"MID ",eng:"ENGAGEMENT",mood:"MOOD",indivSegKeyMap:"med_percentage",category:"Medium",valMin:40,valMax:80,className:"title-warning16-400",color:"#D5AD2A"},{name:"LOW ",eng:"ENGAGEMENT",mood:"MOOD",indivSegKeyMap:"low_percentage",category:"Low",valMin:0,valMax:40,className:"title-danger16-400",color:"#BA0E15"}],this.segmentDuration=[{name:"1st hour",value:1,selected:!0}],this.metricType={category:"",engagement:"",segmentName:"",engType:"Session",percentArr:[]},this.categoryFilterVal="category",this.segSpecificData={name:[],percent:[],participantsCount:[],users:[],moodPercent:[],moodParticipantsCount:[],moodUsers:[],categoryText:"",categoryMetric:"",category:"",color:"",iconClassName:""},this.sectionData={count:[],percent:[],moodCount:[],moodPercent:[]},this.route.queryParams.subscribe(t=>{t&&(this.roomId=t.roomid)})}ngOnInit(){this.api.getApiStatic("avg-engagement-req?roomid="+this.roomId).subscribe(t=>{this.studentData=t,0===this.segmentData.length&&this.createSegment(this.studentData||"[]")}),this.generateReport(this.roomId),this.userDetails=JSON.parse(localStorage.getItem("userDetails")),this.email=this.userDetails.email,this.api.getApiStatic("userplanDetails?email="+this.email).subscribe(t=>{this.linkEnabled=t.data[0].postMeetingAnalytics}),this.bhvSub.engOrMood$.subscribe(t=>{this.engOrMood=t,this.categoryFilterVal=t?"category":"moodCategory",this.metricType.engType=0===t?"Session":"Mood",this.metricType.category=0===t?"segCategory":"segMoodCategory",this.metricType.segmentName=0===t?"ENGAGEMENT":"MOOD"})}generateReport(t){this.api.getApiStatic("getReportData?roomid="+this.roomId).subscribe(e=>{let i;this.studentReportData=e,this.reportData=e.report,this.createrId=e.report.creator_ID,null===e.report.pdf?this.api.getApiStatic("getPdfData?roomid="+this.roomId).subscribe(e=>{202===e.code?i=setInterval(()=>{this.generateReport(t)},500):200===e.code?this.callDetails=e.pdf:404===(null==e?void 0:e.code)&&(clearInterval(i),this.api.getApiStatic(`generatePdfData?roomid=${this.roomId}&creator_ID=${this.createrId}`).subscribe(t=>{this.callDetails=t.report},t=>console.error("Generate Report API error",t)))}):this.callDetails=e.report.pdf,this.getDashboardData(this.reportData)})}createSegment(t){if(t.forEach(t=>{t.stdCallDuration=this.utility.convertDate(t.engagement_avg,60)}),this.callDetails){this.duration=this.utility.calculateDuration(t).duration,this.duration>3600&&this.segmentDuration.push({name:"2nd hour",value:2,selected:!1}),this.duration=Math.round(this.duration/4);for(let e=1;e<=4;e++){this.headingDuration=this.utility.convertDate(1*this.duration,this.callDetails.callDuration);const i={segment:e,data:[],metricAverage:{high:0,medium:0,low:0,camOff:0},moodAverage:{high:0,medium:0,low:0,camOff:0},catSpecificData:{high:[],medium:[],low:[],camOff:[]},metricCount:0,duration:this.utility.convertDate(this.duration*(e-1),this.callDetails.callDuration)+" - "+this.utility.convertDate(this.duration*e,this.callDetails.callDuration)},a=JSON.parse(JSON.stringify(t));1===e&&(this.callDetails.engagementAvg=0),a.map(t=>(1===e&&(this.callDetails.engagementAvg+=null!==t.engagement_avg?t.engagement_avg:0),t.segEngagement=0,t.segMood=0,t.category=this.utility.setCategory(t.engagement),t.engagement_data=t.session_data.filter(i=>{if(i.segment>=this.duration*(e-1)&&i.segment<this.duration*e)return i.category=this.utility.setCategory(i.engagement),i.moodCategory=this.utility.setCategory(i.mood),t.segMood+=null!==i.mood?i.mood:0,t.segEngagement+=null!==i.engagement?i.engagement:0,i}),t.segMood=t.segMood?Math.round(t.segMood/t.engagement_data.length):null,t.segEngagement=t.segEngagement?Math.round(t.segEngagement/t.engagement_data.length):null,t.segCategory=this.utility.setCategory(t.engagement_avg),i.metricCount+=t.session_data.length,i.data.push(t),t));for(let t=0;1===e&&t<3;t++)i.catSpecificData[""+this.segments[t].category.toLowerCase()]=i.data.filter(e=>e.segCategory===""+this.segments[t].category),i.metricAverage[""+this.segments[t].category.toLowerCase()]=i.data.filter(e=>e.segCategory===""+this.segments[t].category).length,i.moodAverage[""+this.segments[t].category.toLowerCase()]=i.data.filter(e=>e.segMoodCategory===""+this.segments[t].category).length;this.zone.run(()=>this.segmentData.push(i))}this.callDetails.engagementAvg=Math.round(this.callDetails.engagementAvg/t.length)}}getDashboardData(t){let e=1;t&&(null==t?void 0:t.pieData.length)&&(null==t?void 0:t.overallEngagement.length)?(this.pieChartData=t.pieData.map(t=>(t.UAE.map(t=>{t.average=t.average.toFixed(2),t.average_mood=t.average_mood.toFixed(2)}),t)),this.sessionDataSeconds=t.overallEngagement.map(t=>(t.segment=e++,t.category=this.utility.setCategory(t.average_engagement),t.moodCategory=this.utility.setCategory(t.average_mood),t)),this.sessionDataMinutes=this.dashService.SecArrToMinuteArr(t.overallEngagement)):(console.error("Data Not Available"),this.gettingData=!0)}spline(t){this.router.navigate(["report/category-detail"],{queryParams:{catType:t.category.toLowerCase()},queryParamsHandling:"merge"})}segmentWiseScore(t){for(let e=0;e<4;e++)this.dashService.updateArr(e,t,this)}studentListPanel(t){this.dispStdList=t}getCategoryVal(){return this.categoryFilterVal}individualSegmentScores(t){this.segSpecificData.name=[{name:t.name+"ENGAGEMENT"},{name:t.name+"MOOD"}],this.segSpecificData.categoryText=t.name,this.segSpecificData.categoryMetric=0===this.engOrMood?"ENGAGEMENT":"MOOD",this.segSpecificData.category=t.category,this.segSpecificData.color=t.color,this.segSpecificData.iconClassName=t.className,this.segSpecificData.percent=[],this.segSpecificData.participantsCount=[],this.segSpecificData.users=[],this.segSpecificData.moodPercent=[],this.segSpecificData.moodParticipantsCount=[],this.segSpecificData.moodUsers=[],this.dispCatSpecificData=!0,this.dispStdList=!1;for(let e=0;e<this.pieChartData.length;e++)this.segSpecificData.percent[e]=this.pieChartData[e][""+t.indivSegKeyMap][0].toFixed(2),this.segSpecificData.participantsCount[e]=this.pieChartData[e][""+t.indivSegKeyMap][1].uuid.length,this.segSpecificData.users[e]="CAMERA OFF "!==t.name?this.pieChartData[e].UAE.filter(e=>e.category===t.category):[],this.segSpecificData.moodPercent[e]=this.pieChartData[e][""+t.indivSegKeyMap][3].toFixed(2),this.segSpecificData.moodParticipantsCount[e]=this.pieChartData[e][""+t.indivSegKeyMap][2].uuid.length,this.segSpecificData.moodUsers[e]="CAMERA OFF "!==t.name?this.pieChartData[e].UAE.filter(e=>e.moodCategory===t.category):[]}changeStatus(){this.minuteToggle=!this.minuteToggle,this.repo._dataSource.next(this.minuteToggle)}}return t.\u0275fac=function(e){return new(e||t)(s.Rb(r.b),s.Rb(c.e),s.Rb(a.a),s.Rb(o.a),s.Rb(r.a),s.Rb(l.a),s.Rb(s.h),s.Rb(g.a),s.Rb(n.a),s.Rb(s.B),s.Rb(d.a),s.Rb(h.a),s.Rb(u.b))},t.\u0275cmp=s.Lb({type:t,selectors:[["app-dashboard"]],features:[s.Eb([a.a,n.a,o.a])],decls:3,vars:3,consts:[["fxLayout","column","fxFill","","padding","",4,"ngIf"],[4,"ngIf"],[3,"ngClass","diameter",4,"ngIf"],["fxLayout","column","fxFill","","padding",""],["fxLayout","row","fxLayoutAlign","center center","fxFlex","",2,"margin-top","-50px !important",3,"ngStyle"],["fxLayout","column","fxFlex","100"],["fxLayout","row","fxLayoutAlign","end center","p-r24","","p-l24","","border",""],["title-white12-400",""],["m-r12","","m-l12","",3,"checked","change"],["fxFlex","",3,"overallData"],["fxLayout","row","m-b20","","title-white12-200","",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between","fxFlex",""],["fxFlex","25","fxLayout","column","fxLayoutGap","10px",4,"ngFor","ngForOf"],["fxLayout","row","style","position: relative; ",4,"ngIf"],["fxLayout","row","fxLayoutGap","16px","fxLayoutAlign","space-around center","style","position: relative",4,"ngIf"],["fxLayout","row","m-b20","","title-white12-200",""],["fxFlex","25","fxLayout","column","fxLayoutGap","10px"],["title-white18-400","","fxLayoutAlign","center center","padding","",2,"border-left","1px solid #707070","border-right","1px solid #707070"],["fxFlex","100","pointer","",3,"inpIn","pieChartData","click"],["title-white18-400","","fxLayoutAlign","center center","style","border-left: 1px solid #707070 ; border-right: 1px solid #707070","padding","",4,"ngIf"],["fxLayout","row","fxLayoutAlign","center center"],[3,"ngStyle","ngClass",4,"ngIf"],[3,"ngStyle","ngClass"],["fxLayout","row",2,"position","relative"],["id","StdList","p-r8",""],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["t-center","","fxFlex","100","fxLayout","column","style","padding: 0 2%;",4,"ngFor","ngForOf"],["t-center","","fxFlex","100","fxLayout","column",2,"padding","0 2%"],["zero","",3,"ngStyle","click"],["xsmall",""],["fxLayout","column","fxFlex","100",3,"ngClass"],[4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","20px","fxFlex","40px",3,"ngClass","routerLink","queryParams","queryParamsHandling","click",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","20px","fxFlex","40px",3,"ngClass","routerLink","queryParams","queryParamsHandling","click"],["id","studentList","fxLayout","column","fxLayoutAlign","center","fxFlex","50"],["id","stdName","title-black12-400","","fxLayoutAlign","start","zero","",2,"text-align","start"],["fxfelx","10","fxLayoutAlign","start center","zero",""],["xsmall","","fxLayoutAlign","start center",3,"ngClass"],["fxFlex","10","xsmall","","fxLayoutAlign","start center","title-black14-500",""],["fxLayout","row","fxLayoutGap","16px","fxLayoutAlign","space-around center",2,"position","relative"],[2,"position","absolute","top","0","right","0"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","title-white12-200","",3,"click"],["fxLayout","column","fxFill","","fxFlex","25",4,"ngFor","ngForOf"],["fxLayout","column","fxFill","","fxFlex","25"],[3,"ngClass"],["fxLayout","column","t-center","",2,"height","100%"],["t-center","","zero","",3,"ngStyle"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","20px","fxFlex","40px",3,"ngClass","routerLink","queryParams","queryParamsHandling","click",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","center","fxFlex","100"],["title-black12-400","","fxLayoutAlign","start","zero","",2,"text-align","start"],["fxflex","10","fxLayoutAlign","start center","zero",""],["fxflex","10","xsmall","","fxLayoutAlign","start center","title-black14-500",""],["fxLayout","column","fxLayoutAlign","center center","fxFill",""],[2,"color","white","padding","1%","border","1px solid white"],[3,"ngClass","diameter"]],template:function(t,e){1&t&&(s.Nc(0,ot,15,9,"div",0),s.Nc(1,st,4,0,"ng-container",1),s.Nc(2,ct,1,3,"mat-spinner",2)),2&t&&(s.qc("ngIf",0!==(null==e.sessionDataMinutes?null:e.sessionDataMinutes.length)&&0!==(null==e.segmentData?null:e.segmentData.length)),s.Fb(1),s.qc("ngIf",e.gettingData),s.Fb(1),s.qc("ngIf",0===(null==e.segmentData?null:e.segmentData.length)&&e.sessionDataMinutes.length))},directives:[c.n,p.f,p.h,p.e,p.b,c.o,m.c,f.a,b.a,c.m,p.g,I,W.a,c.l,m.a,N.a,E.a,X.h,r.c,q.c],pipes:[c.w],styles:["hr[_ngcontent-%COMP%]{border:1px solid #fff}.z[_ngcontent-%COMP%], hr[_ngcontent-%COMP%]{width:100%}.z[_ngcontent-%COMP%]{z-index:10;position:absolute;top:8%}[zero][_ngcontent-%COMP%]{margin:0!important}.details_button[_ngcontent-%COMP%]{border-radius:30px}[mat-raised-button][_ngcontent-%COMP%]{background:#210041;color:#fff}.bullet[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:11px;height:11px}.High[_ngcontent-%COMP%]{border-top:5px solid #00a23e}.Medium[_ngcontent-%COMP%]{border-top:5px solid #d69718}.Low[_ngcontent-%COMP%]{border-top:5px solid #dc3545}.cam_off[_ngcontent-%COMP%]{border-top:5px solid #ccc}.student-card[_ngcontent-%COMP%]{max-height:370px!important;overflow:auto}.upIcon[_ngcontent-%COMP%]{height:50px!important;width:50px!important;font-size:86px!important;color:#fff!important}.customLoader[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.isLink[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{cursor:pointer}.column[_ngcontent-%COMP%]{color:#fff}#studentList[_ngcontent-%COMP%]{height:50%}#stdName[_ngcontent-%COMP%]{width:5em;overflow:hidden;text-overflow:ellipsis}#stdDuration[_ngcontent-%COMP%]{line-height:1}#StdList[_ngcontent-%COMP%]{position:absolute;right:0;top:0}#StdList[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{cursor:pointer}h3[_ngcontent-%COMP%]{font-family:Segoe UI}"]}),t})();var gt=i("zq/I"),dt=i("FpXt"),ht=i("A5z7"),ut=i("BcMA");const pt=[{path:"",component:lt}];let mt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.Pb({type:t}),t.\u0275inj=s.Ob({providers:[n.a],imports:[[dt.a,gt.a,ut.a,N.b,E.b,q.b,ht.e,r.d.forChild(pt),f.b]]}),t})()}}]);