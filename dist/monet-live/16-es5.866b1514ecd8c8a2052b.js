!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"7c3Q":function(t,i,a){"use strict";a.d(i,"a",function(){return O});var o=a("mrSG"),r=a("fXoL"),s=a("pdnW"),c=a("WIjQ"),u=a("G6Tw"),l=a("XNiG"),v=a("kRoH"),d=a("v0EB"),f=a("yB+K"),h=a("0IaG"),b=a("tyNb"),g=a("iiAa"),m=a("tk/3"),p=a("LUsR"),w=a("XiUz"),k=a("bTqV"),y=a("NFeN"),D=a("jaxi"),C=a("ofXK");function E(e,t){if(1&e){var n=r.Yb();r.Xb(0,"mwl-calendar-month-view",19),r.fc("beforeViewRender",function(e){return r.Fc(n),r.jc().beforeMonthViewRender(e,"")})("dayClicked",function(e){return r.Fc(n),r.jc().dayClicked(e.day,e.day)})("eventClicked",function(e){return r.Fc(n),r.jc().handleEvent("Clicked",e.event)})("eventTimesChanged",function(e){return r.Fc(n),r.jc().eventTimesChanged(e)}),r.Wb()}if(2&e){var i=r.jc();r.qc("viewDate",i.viewDate)("events","outlook"===i.loggedInService?i.outlookEvents:i.events)("refresh",i.refresh)("activeDayIsOpen",i.activeDayIsOpen)}}function S(e,t){if(1&e){var n=r.Yb();r.Xb(0,"mwl-calendar-week-view",20),r.fc("eventClicked",function(e){return r.Fc(n),r.jc().handleEvent("Clicked",e.event)})("eventTimesChanged",function(e){return r.Fc(n),r.jc().eventTimesChanged(e)}),r.Wb()}if(2&e){var i=r.jc();r.qc("viewDate",i.viewDate)("events","outlook"===i.loggedInService?i.outlookEvents:i.events)("refresh",i.refresh)}}function I(e,t){if(1&e){var n=r.Yb();r.Xb(0,"mwl-calendar-day-view",20),r.fc("eventClicked",function(e){return r.Fc(n),r.jc().handleEvent("Clicked",e.event)})("eventTimesChanged",function(e){return r.Fc(n),r.jc().eventTimesChanged(e)}),r.Wb()}if(2&e){var i=r.jc();r.qc("viewDate",i.viewDate)("events","outlook"===i.loggedInService?i.outlookEvents:i.events)("refresh",i.refresh)}}var O=function(){var t=function(){function t(n,i,a,o,s,c,u,d){var f=this;e(this,t),this.dialog=n,this.zone=i,this.api=a,this.route=o,this.tps=s,this.utility=c,this.http=u,this.bhvSub=d,this.eventList=new r.o,this.outlookEventList=new r.o,this.loggedInService="",this.selectedDays=[],this.view=v.d.Month,this.CalendarView=v.d,this.date=new Date,this.viewDate=new Date,this.actions=[{label:"edit",a11yLabel:"Edit",onClick:function(e){var t=e.event;f.handleEvent("Edited",t)}},{label:"delete",a11yLabel:"Delete",onClick:function(e){var t=e.event;f.events=f.events.filter(function(e){return e!==t}),f.handleEvent("Deleted",t)}}],this.refresh=new l.a,this.events=[],this.outlookEvents=[],this.activeDayIsOpen=!0}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.route.queryParams.subscribe(function(t){e.params=t}),this.bhvSub.dynamicLink$.subscribe(function(t){e.dynamicLink=t}),this.userDetails=JSON.parse(localStorage.getItem("userDetails")),this.email=this.userDetails.email,this.api.getApiStatic("userplanDetails?email="+this.email).subscribe(function(t){e.meetingDuration=t.data[0].meetingDuration}),this.refreshEvents()}},{key:"ngOnChanges",value:function(e){(null==e?void 0:e.deleteEvent)&&e.deleteEvent.currentValue&&this.deleteCalenderEvent(null==e?void 0:e.deleteEvent.currentValue)}},{key:"refreshEvents",value:function(){var e=this;setTimeout(function(){e.tps.isLoggedIn().status?(e.loggedInService=e.tps.isLoggedIn().service,"google"===e.tps.isLoggedIn().service?e.listUpcomingGoogleEvents():e.listOutlookEvents()):e.loggedInService=e.tps.isLoggedIn().service},5e3)}},{key:"listUpcomingGoogleEvents",value:function(){return Object(o.b)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("gapiAccessToken")){e.next=8;break}return gapi.auth.setToken({access_token:localStorage.getItem("gapiAccessToken")}),e.next=4,this.tps.getGoogleCalenderEvents();case 4:t=e.sent,this.updateEvents(t),e.next=12;break;case 8:return e.next=10,this.tps.getGoogleCalenderEvents();case 10:n=e.sent,this.updateEvents(n);case 12:case"end":return e.stop()}},e,this)}))}},{key:"updateEvents",value:function(e){var t=this,n=[];return e.forEach(function(e){n.push({start:new Date(e.start.dateTime),end:new Date(e.end.dateTime),attendees:e.attendees,title:e.summary})}),this.events=n,this.zone.run(function(){t.eventList.emit(n)}),e}},{key:"dayClicked",value:function(e,t){var n=e.date,i=e.events,a=t.date.getDate().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1}),o=t.date.getFullYear(),r=t.date.toLocaleString("default",{month:"short"}),s=new Date,l=s.getSeconds(),v=s.getMinutes(),d=s.getHours(),f=t.date.getDay();this.finalDateObj=new Date("".concat(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][f].slice(0,3)," ").concat(r," ").concat(a," ").concat(o," ").concat(d,":").concat(v,":").concat(l," GMT+0530 (India Standard Time)")),this.checkDay=t,Object(c.a)(n,this.viewDate)&&(this.activeDayIsOpen=!(Object(u.a)(this.viewDate,n)&&!0===this.activeDayIsOpen||0===i.length),this.viewDate=n)}},{key:"eventTimesChanged",value:function(e){var t=e.event,n=e.newStart,i=e.newEnd;this.events=this.events.map(function(e){return e===t?Object.assign(Object.assign({},t),{start:n,end:i}):e}),this.handleEvent("Dropped or resized",t)}},{key:"handleEvent",value:function(e,t){}},{key:"setView",value:function(e){this.view=e}},{key:"addEvent",value:function(){var e=this;this.dialog.open(s.a,{data:{calDateSelect:this.finalDateObj},hasBackdrop:!0,width:"500px",height:"auto",maxHeight:"508px",backdropClass:"backdropBackground"}).afterClosed().subscribe(function(t){if(t&&t.form){t.form.end=t.end;var n=[];t.emails.map(function(e,t){n[t]={email:e.toString().trim()}}),t.form.attendees=n,e.generateVideoUrl(t).then(function(e){}).catch(function(e){})}})}},{key:"deleteCalenderEvent",value:function(e){return Object(o.b)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:"google"===this.loggedInService?this.tps.deleteGoogleCalenderEvent(e,function(t){t&&n.deleteEventFromDatabase(e,n.loggedInService)}):"outlook"===this.loggedInService&&(this.tps.outlookDeleteEvent(e).subscribe(function(e){},function(e){console.error("Outlook Event Could not be deleted")}),this.deleteEventFromDatabase(e,this.loggedInService));case 1:case"end":return t.stop()}},t,this)}))}},{key:"deleteEventFromDatabase",value:function(e,t){var n=this;this.api.deleteApi("room",e).subscribe(function(e){"google"===t?n.listUpcomingGoogleEvents():"outlook"===t&&n.listOutlookEvents()},function(e){console.error("Delete Api Error")})}},{key:"inviteRoom",value:function(e,t){var n=this;e.attendee=e.attendees,e.creator=JSON.parse(localStorage.getItem("userDetails")||"").name,e.creator_ID=JSON.parse(localStorage.getItem("userDetails")||"").email,e.groupUid=JSON.parse(localStorage.getItem("userDetails")||"").plan.groupUid,e.sourceId=t,e.source=this.loggedInService,e.observerEmail?(e.instance="",e.ip="",e.observerLink="".concat(location.origin,"/monitor?roomid=").concat(e.roomid,"&id=").concat(new Date,"&grp=").concat(e.instance,"&instance=").concat(e.ip,"&summary=").concat(e.summary,"&duration=").concat(JSON.parse(localStorage.getItem("userPlanDetails")||"{}").meetingDuration)):console.error("Dynamic Link and Instance could not be found"),e.scheduled=!0,this.api.postApi1("inviteRoom",e).subscribe(function(e){e.error&&(console.error("Invite Room API error :",e.message),n.utility.notify(e.message,""))},function(e){console.error("Invite Room API Error :",e)})}},{key:"generateVideoUrl",value:function(e){return Object(o.b)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,a,r,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=JSON.parse(localStorage.getItem("userDetails")||""),i=n.name,a=n.email,r=n.settings,this.http.post("https://www.monetlive.com/".concat(this.dynamicLink,"/many/api/createCall"),{source:this.loggedInService,creator:i,creator_ID:a,settings:r}).subscribe(function(t){return Object(o.b)(s,void 0,void 0,regeneratorRuntime.mark(function n(){var i,a,o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t||t.error){n.next=13;break}if("Monet Education"===e.form.link&&(e.form.description="<b>Please join the link below</b><br/>https://www.monetlive.com/student/login?roomid="+t.response.roomid+"&room="+t.response.room+"&matrixScore="+JSON.parse(localStorage.getItem("userPlanDetails")||"{}").realTimeScores+"<br/>"+e.form.description,delete e.form.conferenceData.createRequest),!this.tps.isLoggedIn().status||"google"!==this.tps.isLoggedIn().service){n.next=10;break}return n.next=4,this.tps.createGoogleCalenderEvent(e.form);case 4:return i=n.sent,this.inviteRoom(Object.assign(Object.assign({},t.response),e.form),i),n.next=8,this.listUpcomingGoogleEvents();case 8:n.next=11;break;case 10:this.tps.isLoggedIn().status&&"outlook"===this.tps.isLoggedIn().service?(a=e.emails.map(function(e){return{emailAddress:{address:e}}}),this.tps.outlookCreateEvent(e.form.summary,e.form.body,e.form.start.dateTime,e.form.end.dateTime,a,e.form.description).subscribe(function(n){o.inviteRoom(Object.assign(Object.assign({},t.response),e.form),n.id),o.listOutlookEvents()})):this.inviteRoom(Object.assign(Object.assign({},t.response),e.form),"");case 11:n.next=14;break;case 13:console.error("Create Call Api Error :",null==t?void 0:t.message);case 14:case"end":return n.stop()}},n,this)}))});case 2:case"end":return t.stop()}},t,this)}))}},{key:"closeOpenMonthViewDay",value:function(){this.activeDayIsOpen=!1}},{key:"beforeMonthViewRender",value:function(e,t){var n=this;e.body.forEach(function(e){n.checkDay&&JSON.stringify(n.checkDay.date)==JSON.stringify(e.date)&&(e.cssClass="bg-pink")})}},{key:"listOutlookEvents",value:function(){var e=this;this.tps.outlookGetEvents().subscribe(function(t){var n=[];t.value.forEach(function(e){n.push({start:new Date(e.start.dateTime),end:new Date(e.end.dateTime),attendees:e.attendees,title:e.subject})}),e.outlookEvents=n,e.outlookEventList.emit(n)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(r.Rb(h.b),r.Rb(r.B),r.Rb(d.a),r.Rb(b.a),r.Rb(f.a),r.Rb(g.a),r.Rb(m.b),r.Rb(p.a))},t.\u0275cmp=r.Lb({type:t,selectors:[["app-calendar"]],inputs:{deleteEvent:"deleteEvent"},outputs:{eventList:"eventList",outlookEventList:"outlookEventList"},features:[r.Eb([d.a,f.a]),r.Db],decls:32,vars:13,consts:[["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","20px",2,"background","black","padding","1% 1%"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end center",2,"background","black"],["f-white","","medium",""],["fxLayout","row",2,"background-color","rgba(255, 255 , 255, 0.2)"],["mat-button","","mwlCalendarToday","","f-white","",3,"viewDate","viewDateChange"],["mat-icon-button","","mwlCalendarPreviousView","",3,"view","viewDate","viewDateChange"],["f-white","","small",""],["mat-icon-button","","mwlCalendarNextView","",3,"view","viewDate","viewDateChange"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end center"],["mat-icon-button","","id","refresh",3,"click"],["f-white",""],["name","fontStyle","aria-label","Font Style","value","Month"],["value","Month",3,"click"],["value","Week",3,"click"],["value","Day",3,"click"],["mat-raised-button","",3,"click"],[1,"calendar",3,"ngSwitch"],[3,"viewDate","events","refresh","activeDayIsOpen","beforeViewRender","dayClicked","eventClicked","eventTimesChanged",4,"ngSwitchCase"],[3,"viewDate","events","refresh","eventClicked","eventTimesChanged",4,"ngSwitchCase"],[3,"viewDate","events","refresh","activeDayIsOpen","beforeViewRender","dayClicked","eventClicked","eventTimesChanged"],[3,"viewDate","events","refresh","eventClicked","eventTimesChanged"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Xb(1,"div",1),r.Xb(2,"span",2),r.Pc(3),r.kc(4,"date"),r.Wb(),r.Xb(5,"div",3),r.Xb(6,"button",4),r.fc("viewDateChange",function(e){return t.viewDate=e}),r.Pc(7,"Today"),r.Wb(),r.Xb(8,"button",5),r.fc("viewDateChange",function(e){return t.viewDate=e})("viewDateChange",function(){return t.closeOpenMonthViewDay()}),r.Xb(9,"mat-icon",6),r.Pc(10,"arrow_back_ios"),r.Wb(),r.Wb(),r.Xb(11,"button",7),r.fc("viewDateChange",function(e){return t.viewDate=e})("viewDateChange",function(){return t.closeOpenMonthViewDay()}),r.Xb(12,"mat-icon",6),r.Pc(13,"arrow_forward_ios"),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Xb(14,"div",8),r.Xb(15,"button",9),r.fc("click",function(){return t.refreshEvents()}),r.Xb(16,"mat-icon",10),r.Pc(17,"cached"),r.Wb(),r.Wb(),r.Xb(18,"mat-button-toggle-group",11),r.Xb(19,"mat-button-toggle",12),r.fc("click",function(){return t.setView(t.CalendarView.Month)}),r.Pc(20,"Month"),r.Wb(),r.Xb(21,"mat-button-toggle",13),r.fc("click",function(){return t.setView(t.CalendarView.Week)}),r.Pc(22,"Week"),r.Wb(),r.Xb(23,"mat-button-toggle",14),r.fc("click",function(){return t.setView(t.CalendarView.Day)}),r.Pc(24,"Day"),r.Wb(),r.Wb(),r.Xb(25,"button",15),r.fc("click",function(){return t.addEvent()}),r.Pc(26,"Add Event"),r.Wb(),r.Wb(),r.Wb(),r.Sb(27,"br"),r.Xb(28,"div",16),r.Nc(29,E,1,4,"mwl-calendar-month-view",17),r.Nc(30,S,1,3,"mwl-calendar-week-view",18),r.Nc(31,I,1,3,"mwl-calendar-day-view",18),r.Wb()),2&e&&(r.Fb(3),r.Qc(r.mc(4,10,t.viewDate,"medium")),r.Fb(3),r.qc("viewDate",t.viewDate),r.Fb(2),r.qc("view",t.view)("viewDate",t.viewDate),r.Fb(3),r.qc("view",t.view)("viewDate",t.viewDate),r.Fb(17),r.qc("ngSwitch",t.view),r.Fb(1),r.qc("ngSwitchCase",t.CalendarView.Month),r.Fb(1),r.qc("ngSwitchCase",t.CalendarView.Week),r.Fb(1),r.qc("ngSwitchCase",t.CalendarView.Day))},directives:[w.f,w.e,w.g,k.a,v.i,v.g,y.a,v.h,D.b,D.a,C.p,C.q,v.c,v.e,v.a],pipes:[C.e],styles:[".calendar[_ngcontent-%COMP%]{height:calc(100vh - 120px);overflow-y:auto}  .bg-pink{background-color:#d6eaf8!important}"]}),t}()},je0U:function(t,i,a){"use strict";a.d(i,"a",function(){return r});var o=a("fXoL"),r=function(){var t=function(){function t(){e(this,t)}return n(t,[{key:"transform",value:function(e){if(e){var t=Math.floor(e/1e3/60/60);e-=1e3*t*60*60;var n=Math.floor(e/1e3/60);return e-=1e3*n*60,t?Math.abs(t)+" h, "+n+" m":n+" Minutes"}return"0 Minutes"}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Qb({name:"duration",type:t,pure:!0}),t}()},tqkL:function(t,i,a){"use strict";a.d(i,"a",function(){return I});var o=a("ofXK"),r=a("FpXt"),s=a("0IaG"),c=a("o9rZ"),u=a("L/mj"),l=a("kRoH"),v=a("jaxi"),d=a("bTqV"),f=a("NFeN"),h=a("f0Cb"),b=a("iadO"),g=a("n1FK"),m=a("3Pt+"),p=a("qFsG"),w=a("kmnG"),k=a("Wp6s"),y=a("A5z7"),D=a("/1cH"),C=a("tk/3"),E=a("k78V"),S=a("fXoL"),I=function(){var t=n(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=S.Pb({type:t}),t.\u0275inj=S.Ob({imports:[[o.c,E.a,r.a,s.e,f.b,v.c,d.b,s.e,m.x,p.c,h.b,b.h,g.c,g.e,g.d,w.e,k.b,y.e,C.c,D.b,l.b.forRoot({provide:c.a,useFactory:u.a})]]}),t}()}}])}();